{% extends "base.html" %}

{% block title %} Viewing {% endblock %}

{% block extra_head %}
{# WHY: PDF.js library is required only on PDF pages #} 
<link rel="stylesheet" href="/static/viewer_tpl_style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
<script>
    // Flask-generated proxy URL 
    const PROXY_PDF_URL = "{{ url_for('notes.proxy_pdf')}}";
</script>
{% endblock %}

{% block body %}
<div id="controls">
    <!-- ========================= -->
    <!-- PDF CONTROL BAR -->
    <!-- WHY: Centralized navigation & zoom controls improve usability -->
    <!-- ========================= -->
    <div class="control-group" style="position: absolute; left: 20px;">
        <!-- Back buttom-->
        <button class="icon-btn" onclick="goBack()" title="Back">
            <i class="fas fa-arrow-left"></i>
        </button>
        <!-- Home button -->
        <a href="{{ url_for('notes.index') }}" class="icon-btn" title="Home">
            <i class="fas fa-home"></i>
        </a>
    </div>

    <!-- Page navigation -->
    <!-- WHY: PDF pages must be navigated programmatically -->
    <div class="control-group">
        <button onclick="prevPage()" id="prev-btn">
            <i class="fas fa-chevron-left"></i>
            <span>Previous</span>
        </button>
        <div class="page-info">
            <span id="page_num">1</span> / <span id="page_count">?</span>
        </div>
        <button onclick="nextPage()" id="next-btn">
            <span>Next</span>
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>
    
    <div class="separator"></div>
    
    <!-- Zoom controls -->
    <!-- WHY: PDFs are static; zoom improves readability -->
    <div class="control-group">
        <button onclick="zoomOut()" id="zoom-out-btn">
            <i class="fas fa-search-minus"></i>
        </button>
        <div class="zoom-info">
            <span id="zoom_level">100</span>%
        </div>
        <button onclick="zoomIn()" id="zoom-in-btn">
            <i class="fas fa-search-plus"></i>
        </button>
        <button onclick="resetZoom()" title="Reset Zoom">
            <i class="fas fa-undo"></i>
        </button>
    </div>
</div>

<!-- ========================= -->
<!-- PDF CANVAS AREA -->
<!-- WHY: PDF.js renders pages into a <canvas>, not HTML -->
<!-- ========================= -->
<div id="canvas-container">
    <canvas id="the-canvas"></canvas>
</div>

{% endblock %}

{% block extra_js %}
<script src="/static/viewer.js"></script>
{% endblock%}