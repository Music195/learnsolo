<!DOCTYPE html>
<!-- tags: Data Analysis -->
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Variance &amp; Standard Deviation (分散・標準偏差)
  </title>
  <script>
   MathJax = {
            tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
            svg: {fontCache: 'global'}
        };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <link href="/static/notes_style.css" rel="stylesheet"/>
  <style>
   .interactive-demo {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border: 2px solid #3498db;
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
   }
   .demo-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
    margin-bottom: 20px;
   }
   .control-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
   }
   .control-group label {
    font-weight: bold;
    color: #2c3e50;
   }
   .control-group input, .control-group textarea {
    padding: 8px;
    border: 1px solid #bdc3c7;
    border-radius: 5px;
    font-size: 14px;
   }
   .control-group textarea {
    min-height: 60px;
    resize: vertical;
   }
   .demo-output {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin-top: 15px;
    border: 1px solid #ecf0f1;
   }
   .formula-block {
    background: #ecf0f1;
    border-left: 4px solid #3498db;
    padding: 15px;
    margin: 15px 0;
    font-family: 'Times New Roman', serif;
   }
   .practice-problem {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
   }
   .solution {
    background: #d4edda;
    border: 1px solid #c3e6cb;
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
    display: none;
   }
   .solution-button {
    background: #007bff;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
   }
   .solution-button:hover {
    background: #0056b3;
   }
   .key-takeaways {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
   }
   .key-takeaways h3 {
    margin-top: 0;
    color: white;
   }
   .key-takeaways ul {
    margin: 10px 0 0 0;
    padding-left: 20px;
   }
   .key-takeaways li {
    margin: 8px 0;
   }
   .worked-example {
    background: #e8f4f8;
    border: 1px solid #bee5eb;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
   }
   .worked-example h4 {
    margin-top: 0;
    color: #0c5460;
   }
   .math-foundation {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
   }
   .math-foundation h3 {
    margin-top: 0;
    color: #2c3e50;
   }
   .formula-comparison {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    margin: 20px 0;
   }
   .formula-type {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 15px;
   }
   .formula-type h4 {
    margin-top: 0;
    color: #2c3e50;
   }
   .deviation-visualization {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
   }
   .data-deviations {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    margin: 15px 0;
   }
   .deviation-item {
    background: #3498db;
    color: white;
    padding: 8px 12px;
    border-radius: 5px;
    font-weight: bold;
    position: relative;
    text-align: center;
   }
   .deviation-item.mean {
    background: #e74c3c !important;
    transform: scale(1.1);
   }
   .deviation-label {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    background: #f39c12;
    color: white;
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 11px;
    white-space: nowrap;
   }
   .statistics-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 10px;
    margin: 15px 0;
   }
   .stat-item {
    background: #f8f9fa;
    padding: 10px;
    border-radius: 5px;
    text-align: center;
   }
   .stat-item .value {
    font-size: 1.2em;
    font-weight: bold;
    color: #3498db;
   }
   .stat-item .label {
    font-size: 0.9em;
    color: #666;
   }
   .interpretation-guide {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 15px;
    margin: 20px 0;
   }
   @media (max-width: 768px) {
    .demo-controls {
     flex-direction: column;
     align-items: stretch;
    }
    .control-group {
     width: 100%;
    }
    .formula-comparison {
     grid-template-columns: 1fr;
    }
    .statistics-summary {
     grid-template-columns: repeat(2, 1fr);
    }
   }
  </style>
 </head>
 <body>
  <div class="fancy-title" data-topic="Data Analysis">
   Variance &amp; Standard Deviation (分散・標準偏差)
  </div>
  <div class="container">
   <div class="main-content">

    <div class="math-foundation">
     <h3>Mathematical Foundation</h3>
     <p>Variance and standard deviation are fundamental measures of dispersion that quantify how spread out data points are around the mean. Variance measures the average squared deviation from the mean, while standard deviation is the square root of variance, providing a measure in the same units as the original data. These measures are essential for understanding data variability and are widely used in statistical analysis, quality control, and scientific research.</p>

     <div class="formula-comparison">
      <div class="formula-type">
       <h4>Population Parameters</h4>
       <p><strong>Variance (σ²):</strong></p>
       <div style="font-size: 1.1em; margin: 8px 0;">
        \( \sigma^2 = \dfrac{1}{N} \sum_{i=1}^{N} (x_i - \mu)^2 \)
       </div>
       <p><strong>Standard Deviation (σ):</strong></p>
       <div style="font-size: 1.1em; margin: 8px 0;">
        \( \sigma = \sqrt{\dfrac{1}{N} \sum_{i=1}^{N} (x_i - \mu)^2} \)
       </div>
       <p style="font-size: 0.9em; color: #666;">Used when analyzing entire populations</p>
      </div>
      <div class="formula-type">
       <h4>Sample Statistics</h4>
       <p><strong>Variance (s²):</strong></p>
       <div style="font-size: 1.1em; margin: 8px 0;">
        \( s^2 = \dfrac{1}{n-1} \sum_{i=1}^{n} (x_i - \overline{x})^2 \)
       </div>
       <p><strong>Standard Deviation (s):</strong></p>
       <div style="font-size: 1.1em; margin: 8px 0;">
        \( s = \sqrt{\dfrac{1}{n-1} \sum_{i=1}^{n} (x_i - \overline{x})^2} \)
       </div>
       <p style="font-size: 0.9em; color: #666;">Used when analyzing samples (n-1 denominator)</p>
      </div>
     </div>
    </div>

    <div class="interpretation-guide">
     <h4>Understanding Variance and Standard Deviation</h4>
     <ul>
      <li><strong>Variance:</strong> Average of squared deviations from the mean - measures dispersion in squared units</li>
      <li><strong>Standard Deviation:</strong> Square root of variance - measures dispersion in original units</li>
      <li><strong>Low values:</strong> Data points are close to the mean (less spread)</li>
      <li><strong>High values:</strong> Data points are far from the mean (more spread)</li>
      <li><strong>Units:</strong> Variance in squared units, standard deviation in original units</li>
     </ul>
    </div>

    <div class="interactive-demo">
     <h3>Interactive Variance & Standard Deviation Calculator</h3>
     <div class="demo-controls">
      <div class="control-group">
       <label for="data-input">Data Values (comma-separated):</label>
       <textarea id="data-input" placeholder="e.g., 2, 4, 6, 8, 10">2, 4, 6, 8, 10</textarea>
      </div>
      <div class="control-group">
       <label for="calculation-type">Calculation Type:</label>
       <select id="calculation-type" style="padding: 8px; border: 1px solid #bdc3c7; border-radius: 5px;">
        <option value="sample">Sample (divide by n-1)</option>
        <option value="population">Population (divide by n)</option>
       </select>
      </div>
      <button onclick="calculateVarianceSD()" style="padding: 8px 16px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer; align-self: flex-end;">Calculate</button>
     </div>

     <div class="deviation-visualization" id="deviation-viz">
      <h4>Data Deviation Visualization</h4>
      <div id="data-deviations" class="data-deviations"></div>
     </div>

     <div class="demo-output" id="demo-output">
      <strong>Current Data:</strong> [2, 4, 6, 8, 10]<br>
      <strong>Mean (μ):</strong> 6<br>
      <div class="statistics-summary">
       <div class="stat-item">
        <div class="value">8</div>
        <div class="label">Variance (s²)</div>
       </div>
       <div class="stat-item">
        <div class="value">2.83</div>
        <div class="label">Std Dev (s)</div>
       </div>
       <div class="stat-item">
        <div class="value">8</div>
        <div class="label">Range</div>
       </div>
       <div class="stat-item">
        <div class="value">2</div>
        <div class="label">Min</div>
       </div>
       <div class="stat-item">
        <div class="value">10</div>
        <div class="label">Max</div>
       </div>
      </div>
     </div>
    </div>

    <div class="worked-example">
     <h4>Worked Example 1: Sample Standard Deviation</h4>
     <p>Calculate the variance and standard deviation for: 4, 6, 8, 10, 12</p>
     <p><strong>Solution:</strong></p>
     <p>Mean = (4+6+8+10+12)/5 = 8</p>
     <p>Deviations: 4-8=-4, 6-8=-2, 8-8=0, 10-8=2, 12-8=4</p>
     <p>Squared deviations: 16, 4, 0, 4, 16</p>
     <p>Sum of squared deviations = 40</p>
     <p>Variance = 40/(5-1) = 10</p>
     <p>Standard deviation = √10 ≈ 3.16</p>
    </div>

    <div class="worked-example">
     <h4>Worked Example 2: Population Standard Deviation</h4>
     <p>For the entire population: 2, 4, 6, 8, find variance and standard deviation.</p>
     <p><strong>Solution:</strong></p>
     <p>Mean = (2+4+6+8)/4 = 5</p>
     <p>Deviations: 2-5=-3, 4-5=-1, 6-5=1, 8-5=3</p>
     <p>Squared deviations: 9, 1, 1, 9</p>
     <p>Sum of squared deviations = 20</p>
     <p>Variance = 20/4 = 5</p>
     <p>Standard deviation = √5 ≈ 2.24</p>
    </div>

    <div class="worked-example">
     <h4>Worked Example 3: Comparing Spread</h4>
     <p>Dataset A: 5, 5, 5, 5, 5 (mean=5, std dev=0)</p>
     <p>Dataset B: 1, 3, 5, 7, 9 (mean=5, std dev≈2.83)</p>
     <p><strong>Analysis:</strong></p>
     <p>Dataset A has no variability (all values equal to mean)</p>
     <p>Dataset B has greater spread around the mean</p>
    </div>

    <h3>Practice Problems</h3>

    <div class="practice-problem">
     <strong>Problem 1:</strong> Calculate variance and standard deviation for: 3, 5, 7, 9, 11 (sample)
     <br><button class="solution-button" onclick="toggleSolution(1)">Show Solution</button>
     <div class="solution" id="solution1">
      <strong>Solution:</strong><br>
      Mean = 7<br>
      Deviations: -4, -2, 0, 2, 4<br>
      Squared: 16, 4, 0, 4, 16<br>
      Sum = 40<br>
      Variance = 40/4 = 10<br>
      Std Dev = √10 ≈ 3.16
     </div>
    </div>

    <div class="practice-problem">
     <strong>Problem 2:</strong> For population data: 1, 2, 3, 4, 5, find variance and standard deviation.
     <br><button class="solution-button" onclick="toggleSolution(2)">Show Solution</button>
     <div class="solution" id="solution2">
      <strong>Solution:</strong><br>
      Mean = 3<br>
      Deviations: -2, -1, 0, 1, 2<br>
      Squared: 4, 1, 0, 1, 4<br>
      Sum = 10<br>
      Variance = 10/5 = 2<br>
      Std Dev = √2 ≈ 1.41
     </div>
    </div>

    <div class="practice-problem">
     <strong>Problem 3:</strong> Two datasets have the same mean. Dataset A has variance 4, Dataset B has variance 16. Which has greater spread?
     <br><button class="solution-button" onclick="toggleSolution(3)">Show Solution</button>
     <div class="solution" id="solution3">
      <strong>Solution:</strong><br>
      Dataset B has greater spread (variance 16 > variance 4).<br>
      Standard deviations: Dataset A = 2, Dataset B = 4.
     </div>
    </div>

    <div class="practice-problem">
     <strong>Problem 4:</strong> If standard deviation is 5, what is the variance?
     <br><button class="solution-button" onclick="toggleSolution(4)">Show Solution</button>
     <div class="solution" id="solution4">
      <strong>Solution:</strong><br>
      Variance = (standard deviation)² = 5² = 25
     </div>
    </div>

    <div class="practice-problem">
     <strong>Problem 5:</strong> Calculate sample standard deviation for: 10, 12, 14, 16, 18
     <br><button class="solution-button" onclick="toggleSolution(5)">Show Solution</button>
     <div class="solution" id="solution5">
      <strong>Solution:</strong><br>
      Mean = 14<br>
      Deviations: -4, -2, 0, 2, 4<br>
      Squared: 16, 4, 0, 4, 16<br>
      Sum = 40<br>
      Variance = 40/4 = 10<br>
      Std Dev = √10 ≈ 3.16
     </div>
    </div>

    <div style="margin: 30px 0;">
     <strong>Properties of Variance and Standard Deviation:</strong>
     <ul>
      <li>Variance is always non-negative (≥ 0)</li>
      <li>Variance = 0 only when all values equal the mean</li>
      <li>Standard deviation has same units as original data</li>
      <li>Affected by every data point (not robust to outliers)</li>
      <li>Sample standard deviation uses n-1 (Bessel's correction)</li>
      <li>Population standard deviation uses N</li>
     </ul>
    </div>

    <div style="margin: 30px 0;">
     <strong>Applications:</strong>
     <ul>
      <li><strong>Quality Control:</strong> Monitoring process variability</li>
      <li><strong>Risk Assessment:</strong> Measuring investment volatility</li>
      <li><strong>Scientific Research:</strong> Quantifying experimental error</li>
      <li><strong>Education:</strong> Assessing test score consistency</li>
      <li><strong>Weather:</strong> Measuring temperature variability</li>
     </ul>
    </div>

    <div class="key-takeaways">
     <h3>Key Takeaways</h3>
     <ul>
      <li><strong>Variance:</strong> Average squared deviation from mean - measures spread in squared units.</li>
      <li><strong>Standard Deviation:</strong> Square root of variance - measures spread in original units.</li>
      <li><strong>Sample vs Population:</strong> Sample uses n-1 denominator, population uses N.</li>
      <li><strong>Interpretation:</strong> Larger values indicate greater data spread around the mean.</li>
      <li><strong>Units:</strong> Variance in squared units, standard deviation in original units.</li>
      <li><strong>Zero Value:</strong> Occurs only when all data points equal the mean.</li>
      <li><strong>Outliers:</strong> Highly affected by extreme values (not robust).</li>
      <li><strong>Relationship:</strong> Standard deviation = √variance, variance = (standard deviation)².</li>
     </ul>
    </div>

    <script>
     function calculateVarianceSD() {
      const input = document.getElementById('data-input').value;
      const values = input.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));

      if (values.length < 2) {
       alert('Please enter at least 2 values.');
       return;
      }

      const calculationType = document.getElementById('calculation-type').value;
      const n = values.length;

      // Calculate mean
      const mean = values.reduce((sum, val) => sum + val, 0) / n;

      // Calculate deviations and squared deviations
      const deviations = values.map(val => val - mean);
      const squaredDeviations = deviations.map(dev => dev * dev);
      const sumSquaredDeviations = squaredDeviations.reduce((sum, val) => sum + val, 0);

      // Calculate variance
      const divisor = calculationType === 'sample' ? n - 1 : n;
      const variance = sumSquaredDeviations / divisor;

      // Calculate standard deviation
      const stdDev = Math.sqrt(variance);

      // Calculate range
      const min = Math.min(...values);
      const max = Math.max(...values);
      const range = max - min;

      // Update visualization
      updateDeviationVisualization(values, mean, deviations);

      // Update output
      const output = document.getElementById('demo-output');
      output.innerHTML = `<strong>Current Data:</strong> [${values.join(', ')}]<br>
      <strong>Mean (${calculationType === 'sample' ? 'x̄' : 'μ'}):</strong> ${mean.toFixed(2)}<br>
      <strong>Calculation Type:</strong> ${calculationType.charAt(0).toUpperCase() + calculationType.slice(1)}<br>
      <div class="statistics-summary">
       <div class="stat-item">
        <div class="value">${variance.toFixed(2)}</div>
        <div class="label">Variance (${calculationType === 'sample' ? 's²' : 'σ²'})</div>
       </div>
       <div class="stat-item">
        <div class="value">${stdDev.toFixed(2)}</div>
        <div class="label">Std Dev (${calculationType === 'sample' ? 's' : 'σ'})</div>
       </div>
       <div class="stat-item">
        <div class="value">${range}</div>
        <div class="label">Range</div>
       </div>
       <div class="stat-item">
        <div class="value">${min}</div>
        <div class="label">Min</div>
       </div>
       <div class="stat-item">
        <div class="value">${max}</div>
        <div class="label">Max</div>
       </div>
      </div>`;

      // Re-render MathJax
      if (window.MathJax) {
       MathJax.typesetPromise([output]).catch(function(err) {
        console.log('MathJax re-render error:', err);
       });
      }
     }

     function updateDeviationVisualization(values, mean, deviations) {
      const container = document.getElementById('data-deviations');

      // Clear previous content
      container.innerHTML = '';

      // Create data items
      values.forEach((value, index) => {
       const item = document.createElement('div');
       item.className = 'deviation-item';
       item.textContent = value;

       // Add deviation label
       const label = document.createElement('div');
       label.className = 'deviation-label';
       label.textContent = deviations[index].toFixed(1);
       item.appendChild(label);

       // Highlight mean
       if (Math.abs(value - mean) < 0.001) {
        item.classList.add('mean');
       }

       container.appendChild(item);
      });
     }

     function toggleSolution(num) {
      const solution = document.getElementById('solution' + num);
      if (solution.style.display === 'none' || solution.style.display === '') {
       solution.style.display = 'block';
      } else {
       solution.style.display = 'none';
      }
     }

     // Initialize with default data
     calculateVarianceSD();
    </script>
   </div>
  </div>
 </body>
</html>
