<!DOCTYPE html>
<!-- tags: Data Analysis -->
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Positive &amp; Negative Correlation (正の相関・負の相関)
  </title>
  <script>
   MathJax = {
            tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
            svg: {fontCache: 'global'}
        };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <link href="/static/notes_style.css" rel="stylesheet"/>
  <style>
   .interactive-demo {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border: 2px solid #3498db;
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
   }
   .demo-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
    margin-bottom: 20px;
   }
   .control-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
   }
   .control-group label {
    font-weight: bold;
    color: #2c3e50;
   }
   .control-group input, .control-group textarea {
    padding: 8px;
    border: 1px solid #bdc3c7;
    border-radius: 5px;
    font-size: 14px;
   }
   .control-group textarea {
    min-height: 60px;
    resize: vertical;
   }
   .demo-output {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin-top: 15px;
    border: 1px solid #ecf0f1;
   }
   .formula-block {
    background: #ecf0f1;
    border-left: 4px solid #3498db;
    padding: 15px;
    margin: 15px 0;
    font-family: 'Times New Roman', serif;
   }
   .practice-problem {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
   }
   .solution {
    background: #d4edda;
    border: 1px solid #c3e6cb;
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
    display: none;
   }
   .solution-button {
    background: #007bff;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
   }
   .solution-button:hover {
    background: #0056b3;
   }
   .key-takeaways {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
   }
   .key-takeaways h3 {
    margin-top: 0;
    color: white;
   }
   .key-takeaways ul {
    margin: 10px 0 0 0;
    padding-left: 20px;
   }
   .key-takeaways li {
    margin: 8px 0;
   }
   .worked-example {
    background: #e8f4f8;
    border: 1px solid #bee5eb;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
   }
   .worked-example h4 {
    margin-top: 0;
    color: #0c5460;
   }
   .math-foundation {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
   }
   .math-foundation h3 {
    margin-top: 0;
    color: #2c3e50;
   }
   .correlation-types {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    margin: 20px 0;
   }
   .correlation-type {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
   }
   .correlation-type h4 {
    margin-top: 0;
    color: #2c3e50;
   }
   .correlation-type .description {
    font-size: 14px;
    color: #666;
    margin-top: 10px;
   }
   .correlation-diagram {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 20px;
    margin: 10px;
    text-align: center;
   }
   .correlation-title {
    font-weight: bold;
    margin-bottom: 15px;
    color: #2c3e50;
   }
   .scatter-plot {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
   }
   .plot-container {
    position: relative;
    width: 100%;
    max-width: 400px;
    height: 300px;
    margin: 0 auto;
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 5px;
   }
   .plot-axis {
    position: absolute;
    font-size: 12px;
    color: #666;
   }
   .x-axis-label {
    bottom: -25px;
    left: 50%;
    transform: translateX(-50%);
   }
   .y-axis-label {
    left: -30px;
    top: 50%;
    transform: translateY(-50%) rotate(-90deg);
   }
   .data-point {
    position: absolute;
    width: 8px;
    height: 8px;
    background: #3498db;
    border-radius: 50%;
    transform: translate(-50%, -50%);
   }
   .trend-line {
    position: absolute;
    height: 2px;
    background: #e74c3c;
    transform-origin: left center;
   }
   .correlation-strength {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin: 20px 0;
   }
   .strength-example {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
   }
   .strength-example h5 {
    margin-top: 0;
    color: #2c3e50;
   }
   .real-world-examples {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 15px;
    margin: 20px 0;
   }
   .correlation-analysis {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
   }
   .correlation-result {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 15px 0;
    flex-wrap: wrap;
   }
   .correlation-stat {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    text-align: center;
    min-width: 120px;
   }
   .correlation-stat .value {
    font-size: 1.5em;
    font-weight: bold;
    color: #3498db;
   }
   .correlation-stat .label {
    font-size: 0.9em;
    color: #666;
    margin-top: 5px;
   }
   .caution-note {
    background: #f8d7da;
    border: 1px solid #f5c6cb;
    border-radius: 8px;
    padding: 15px;
    margin: 20px 0;
   }
   @media (max-width: 768px) {
    .demo-controls {
     flex-direction: column;
     align-items: stretch;
    }
    .control-group {
     width: 100%;
    }
    .correlation-types {
     grid-template-columns: 1fr;
    }
    .correlation-strength {
     grid-template-columns: 1fr;
    }
    .correlation-result {
     flex-direction: column;
     align-items: center;
    }
   }
  </style>
 </head>
 <body>
  <div class="fancy-title" data-topic="Data Analysis">
   Positive &amp; Negative Correlation (正の相関・負の相関)
  </div>
  <div class="container">
   <div class="main-content">

    <div class="math-foundation">
     <h3>Mathematical Foundation</h3>
     <p>Correlation measures the strength and direction of the linear relationship between two variables. Positive correlation indicates that as one variable increases, the other tends to increase as well. Negative correlation indicates that as one variable increases, the other tends to decrease. The strength of correlation is measured by the correlation coefficient, which ranges from -1 (perfect negative correlation) to +1 (perfect positive correlation), with 0 indicating no linear relationship.</p>

     <div class="formula-block">
      <strong>Correlation Coefficient (r):</strong>
      <div style="font-size: 1.1em; margin: 10px 0;">
       \( r = \dfrac{\sum (x_i - \overline{x})(y_i - \overline{y})}{\sqrt{\sum (x_i - \overline{x})^2 \sum (y_i - \overline{y})^2}} \)
      </div>
      <p><strong>Interpretation of r:</strong></p>
      <ul>
       <li><strong>+1:</strong> Perfect positive correlation</li>
       <li><strong>0:</strong> No linear correlation</li>
       <li><strong>-1:</strong> Perfect negative correlation</li>
      </ul>
     </div>
    </div>

    <div class="correlation-types">
     <div class="correlation-type">
      <h4>Positive Correlation</h4>
      <div class="description">Both variables increase together<br><strong>Example:</strong> Height and weight</div>
     </div>
     <div class="correlation-type">
      <h4>Negative Correlation</h4>
      <div class="description">One variable increases, other decreases<br><strong>Example:</strong> Speed and travel time</div>
     </div>
     <div class="correlation-type">
      <h4>No Correlation</h4>
      <div class="description">No relationship between variables<br><strong>Example:</strong> Shoe size and IQ</div>
     </div>
     <div class="correlation-type">
      <h4>Non-linear Relationship</h4>
      <div class="description">Correlation ≠ 0, but not linear<br><strong>Example:</strong> Age and happiness</div>
     </div>
    </div>

    <div class="correlation-row">
     <div class="correlation-diagram">
      <div class="correlation-title">
       Positive Correlation
      </div>
      <svg height="120" width="160">
       <rect fill="#fff" height="120" width="160" x="0" y="0"></rect>
       <line stroke="#1976d2" stroke-width="2" x1="20" x2="140" y1="100" y2="20"></line>
       <circle cx="30" cy="90" fill="#ff7043" r="5"></circle>
       <circle cx="50" cy="75" fill="#ff7043" r="5"></circle>
       <circle cx="70" cy="60" fill="#ff7043" r="5"></circle>
       <circle cx="90" cy="45" fill="#ff7043" r="5"></circle>
       <circle cx="120" cy="30" fill="#ff7043" r="5"></circle>
      </svg>
     </div>
     <div class="correlation-diagram">
      <div class="correlation-title">
       Negative Correlation
      </div>
      <svg height="120" width="160">
       <rect fill="#fff" height="120" width="160" x="0" y="0"></rect>
       <line stroke="#1976d2" stroke-width="2" x1="20" x2="140" y1="20" y2="100"></line>
       <circle cx="30" cy="30" fill="#ff7043" r="5"></circle>
       <circle cx="50" cy="45" fill="#ff7043" r="5"></circle>
       <circle cx="70" cy="60" fill="#ff7043" r="5"></circle>
       <circle cx="90" cy="75" fill="#ff7043" r="5"></circle>
       <circle cx="120" cy="90" fill="#ff7043" r="5"></circle>
      </svg>
     </div>
    </div>

    <div class="correlation-strength">
     <div class="strength-example">
      <h5>Strong Positive</h5>
      <div>r ≈ 0.8 to 1.0</div>
      <div style="font-size: 12px; color: #666; margin-top: 5px;">Points cluster tightly around upward trend</div>
     </div>
     <div class="strength-example">
      <h5>Weak Positive</h5>
      <div>r ≈ 0.3 to 0.5</div>
      <div style="font-size: 12px; color: #666; margin-top: 5px;">Upward trend but scattered points</div>
     </div>
     <div class="strength-example">
      <h5>Weak Negative</h5>
      <div>r ≈ -0.3 to -0.5</div>
      <div style="font-size: 12px; color: #666; margin-top: 5px;">Downward trend but scattered points</div>
     </div>
     <div class="strength-example">
      <h5>Strong Negative</h5>
      <div>r ≈ -0.8 to -1.0</div>
      <div style="font-size: 12px; color: #666; margin-top: 5px;">Points cluster tightly around downward trend</div>
     </div>
    </div>

    <div class="interactive-demo">
     <h3>Interactive Scatter Plot & Correlation Calculator</h3>
     <div class="demo-controls">
      <div class="control-group">
       <label for="x-data">X Values (comma-separated):</label>
       <input id="x-data" placeholder="e.g., 1, 2, 3, 4, 5" value="1, 2, 3, 4, 5">
      </div>
      <div class="control-group">
       <label for="y-data">Y Values (comma-separated):</label>
       <input id="y-data" placeholder="e.g., 2, 4, 6, 8, 10" value="2, 4, 6, 8, 10">
      </div>
      <button onclick="generateScatterPlot()" style="padding: 8px 16px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer; align-self: flex-end;">Generate Plot</button>
     </div>

     <div class="scatter-plot">
      <div class="plot-container" id="scatter-plot-container">
       <div class="plot-axis x-axis-label">X Variable</div>
       <div class="plot-axis y-axis-label">Y Variable</div>
      </div>
     </div>

     <div class="demo-output" id="demo-output">
      <strong>Current Data:</strong><br>
      X: [1, 2, 3, 4, 5]<br>
      Y: [2, 4, 6, 8, 10]<br>
      <div class="correlation-result">
       <div class="correlation-stat">
        <div class="value">1.00</div>
        <div class="label">Correlation (r)</div>
       </div>
       <div class="correlation-stat">
        <div class="value">Positive</div>
        <div class="label">Direction</div>
       </div>
       <div class="correlation-stat">
        <div class="value">Perfect</div>
        <div class="label">Strength</div>
       </div>
      </div>
     </div>
    </div>

    <div class="worked-example">
     <h4>Worked Example 1: Positive Correlation</h4>
     <p>Hours studied: 2, 4, 6, 8, 10</p>
     <p>Test scores: 65, 75, 85, 90, 95</p>
     <p><strong>Analysis:</strong></p>
     <p>As study hours increase, test scores tend to increase.</p>
     <p>This shows a positive correlation between study time and academic performance.</p>
    </div>

    <div class="worked-example">
     <h4>Worked Example 2: Negative Correlation</h4>
     <p>Daily exercise (hours): 0, 1, 2, 3, 4</p>
     <p>Resting heart rate: 80, 75, 70, 65, 60</p>
     <p><strong>Analysis:</strong></p>
     <p>As exercise hours increase, resting heart rate tends to decrease.</p>
     <p>This shows a negative correlation between exercise and resting heart rate.</p>
    </div>

    <div class="worked-example">
     <h4>Worked Example 3: No Correlation</h4>
     <p>Shoe size: 7, 8, 9, 10, 11</p>
     <p>Favorite color (numeric): 3, 1, 2, 3, 1</p>
     <p><strong>Analysis:</strong></p>
     <p>No apparent relationship between shoe size and favorite color.</p>
     <p>This shows little to no correlation between these variables.</p>
    </div>

    <div class="real-world-examples">
     <h4>Real-World Examples</h4>
     <ul>
      <li><strong>Positive:</strong> Temperature and ice cream sales, education level and income</li>
      <li><strong>Negative:</strong> Speed and travel time, price and demand (in some cases)</li>
      <li><strong>No correlation:</strong> Height and intelligence, birth month and lifespan</li>
     </ul>
    </div>

    <div class="caution-note">
     <h4>⚠️ Important: Correlation ≠ Causation</h4>
     <p>Just because two variables are correlated doesn't mean one causes the other. Correlation shows association, not causation. Always consider:</p>
     <ul>
      <li>Third variables that might influence both</li>
      <li>Direction of causality</li>
      <li>Spurious correlations (coincidental relationships)</li>
     </ul>
    </div>

    <h3>Practice Problems</h3>

    <div class="practice-problem">
     <strong>Problem 1:</strong> Describe the correlation: Hours sleeping (4,6,8,10) vs Energy level (3,6,8,9)
     <br><button class="solution-button" onclick="toggleSolution(1)">Show Solution</button>
     <div class="solution" id="solution1">
      <strong>Solution:</strong><br>
      Positive correlation - as sleep hours increase, energy level tends to increase.
     </div>
    </div>

    <div class="practice-problem">
     <strong>Problem 2:</strong> What type of correlation: Age (20,30,40,50) vs Reaction time (0.2,0.3,0.4,0.5)
     <br><button class="solution-button" onclick="toggleSolution(2)">Show Solution</button>
     <div class="solution" id="solution2">
      <strong>Solution:</strong><br>
      Positive correlation - reaction time increases with age.
     </div>
    </div>

    <div class="practice-problem">
     <strong>Problem 3:</strong> Identify correlation direction: Coffee consumption (1,2,3,4,5 cups) vs Alertness (10,8,6,4,2)
     <br><button class="solution-button" onclick="toggleSolution(3)">Show Solution</button>
     <div class="solution" id="solution3">
      <strong>Solution:</strong><br>
      This appears to show negative correlation, but actually demonstrates the limitations of caffeine - too much coffee can lead to decreased alertness due to overstimulation.
     </div>
    </div>

    <div class="practice-problem">
     <strong>Problem 4:</strong> Which shows stronger correlation: r=0.3 or r=-0.7?
     <br><button class="solution-button" onclick="toggleSolution(4)">Show Solution</button>
     <div class="solution" id="solution4">
      <strong>Solution:</strong><br>
      r=-0.7 shows stronger correlation (negative) than r=0.3 (weak positive).
     </div>
    </div>

    <div class="practice-problem">
     <strong>Problem 5:</strong> Can correlation prove causation? Explain with an example.
     <br><button class="solution-button" onclick="toggleSolution(5)">Show Solution</button>
     <div class="solution" id="solution5">
      <strong>Solution:</strong><br>
      No, correlation does not prove causation. Example: Ice cream sales and drowning deaths are positively correlated, but eating ice cream doesn't cause drowning - both increase in summer heat.
     </div>
    </div>

    <div class="key-takeaways">
     <h3>Key Takeaways</h3>
     <ul>
      <li><strong>Positive Correlation:</strong> Both variables increase together (r > 0).</li>
      <li><strong>Negative Correlation:</strong> One variable increases, other decreases (r < 0).</li>
      <li><strong>Correlation Coefficient:</strong> r ranges from -1 to +1, measuring strength and direction.</li>
      <li><strong>Strength Interpretation:</strong> |r| ≥ 0.8 strong, 0.6-0.8 moderate, 0.3-0.6 weak, <0.3 very weak.</li>
      <li><strong>Scatter Plots:</strong> Visual representation of correlation between two variables.</li>
      <li><strong>Correlation ≠ Causation:</strong> Association doesn't imply cause-and-effect relationship.</li>
      <li><strong>Linearity:</strong> Correlation measures linear relationships only.</li>
      <li><strong>Outliers:</strong> Can significantly affect correlation strength and direction.</li>
     </ul>
    </div>

    <script>
     function generateScatterPlot() {
      const xInput = document.getElementById('x-data').value;
      const yInput = document.getElementById('y-data').value;

      const xValues = xInput.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
      const yValues = yInput.split(',').map(y => parseFloat(y.trim())).filter(y => !isNaN(y));

      if (xValues.length !== yValues.length || xValues.length < 2) {
       alert('Please enter equal number of X and Y values (at least 2 pairs).');
       return;
      }

      // Calculate correlation coefficient
      const correlation = calculateCorrelation(xValues, yValues);
      const direction = correlation > 0 ? 'Positive' : correlation < 0 ? 'Negative' : 'None';
      const strength = Math.abs(correlation) >= 0.8 ? 'Strong' :
                      Math.abs(correlation) >= 0.6 ? 'Moderate' :
                      Math.abs(correlation) >= 0.3 ? 'Weak' : 'Very Weak';

      // Update scatter plot
      updateScatterPlot(xValues, yValues);

      // Update output
      const output = document.getElementById('demo-output');
      output.innerHTML = `<strong>Current Data:</strong><br>
      X: [${xValues.join(', ')}]<br>
      Y: [${yValues.join(', ')}]<br>
      <div class="correlation-result">
       <div class="correlation-stat">
        <div class="value">${correlation.toFixed(3)}</div>
        <div class="label">Correlation (r)</div>
       </div>
       <div class="correlation-stat">
        <div class="value">${direction}</div>
        <div class="label">Direction</div>
       </div>
       <div class="correlation-stat">
        <div class="value">${strength}</div>
        <div class="label">Strength</div>
       </div>
      </div>`;

      // Re-render MathJax
      if (window.MathJax) {
       MathJax.typesetPromise([output]).catch(function(err) {
        console.log('MathJax re-render error:', err);
       });
      }
     }

     function calculateCorrelation(x, y) {
      const n = x.length;
      const sumX = x.reduce((a, b) => a + b, 0);
      const sumY = y.reduce((a, b) => a + b, 0);
      const sumXY = x.reduce((sum, xi, i) => sum + xi * y[i], 0);
      const sumX2 = x.reduce((sum, xi) => sum + xi * xi, 0);
      const sumY2 = y.reduce((sum, yi) => sum + yi * yi, 0);

      const numerator = n * sumXY - sumX * sumY;
      const denominator = Math.sqrt((n * sumX2 - sumX * sumX) * (n * sumY2 - sumY * sumY));

      return denominator === 0 ? 0 : numerator / denominator;
     }

     function updateScatterPlot(xValues, yValues) {
      const container = document.getElementById('scatter-plot-container');

      // Clear previous plot
      const existingPoints = container.querySelectorAll('.data-point, .trend-line');
      existingPoints.forEach(point => point.remove());

      // Calculate ranges
      const xMin = Math.min(...xValues);
      const xMax = Math.max(...xValues);
      const yMin = Math.min(...yValues);
      const yMax = Math.max(...yValues);

      const xRange = xMax - xMin || 1;
      const yRange = yMax - yMin || 1;

      // Plot points
      xValues.forEach((x, i) => {
       const y = yValues[i];
       const xPos = 50 + ((x - xMin) / xRange) * 300; // 50px margin, 300px plot area
       const yPos = 250 - ((y - yMin) / yRange) * 200; // 250px from top, 200px plot height

       const point = document.createElement('div');
       point.className = 'data-point';
       point.style.left = xPos + 'px';
       point.style.top = yPos + 'px';
       container.appendChild(point);
      });

      // Add trend line if correlation is significant
      const correlation = calculateCorrelation(xValues, yValues);
      if (Math.abs(correlation) > 0.3) {
       const slope = correlation * (yRange / xRange);
       const intercept = (yMax + yMin) / 2 - slope * (xMax + xMin) / 2;

       const x1 = xMin;
       const y1 = slope * x1 + intercept;
       const x2 = xMax;
       const y2 = slope * x2 + intercept;

       const x1Pos = 50 + ((x1 - xMin) / xRange) * 300;
       const y1Pos = 250 - ((y1 - yMin) / yRange) * 200;
       const x2Pos = 50 + ((x2 - xMin) / xRange) * 300;
       const y2Pos = 250 - ((y2 - yMin) / yRange) * 200;

       const length = Math.sqrt((x2Pos - x1Pos) ** 2 + (y2Pos - y1Pos) ** 2);
       const angle = Math.atan2(y2Pos - y1Pos, x2Pos - x1Pos) * 180 / Math.PI;

       const trendLine = document.createElement('div');
       trendLine.className = 'trend-line';
       trendLine.style.width = length + 'px';
       trendLine.style.left = x1Pos + 'px';
       trendLine.style.top = y1Pos + 'px';
       trendLine.style.transform = `rotate(${angle}deg)`;
       container.appendChild(trendLine);
      }
     }

     function toggleSolution(num) {
      const solution = document.getElementById('solution' + num);
      if (solution.style.display === 'none' || solution.style.display === '') {
       solution.style.display = 'block';
      } else {
       solution.style.display = 'none';
      }
     }

     // Initialize with default data
     generateScatterPlot();
    </script>
   </div>
  </div>
 </body>
</html>
