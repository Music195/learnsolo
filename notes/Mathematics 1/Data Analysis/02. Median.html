<!DOCTYPE html>
<!-- tags: Data Analysis -->
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Median (中央値, メジアン)
  </title>
  <script>
   MathJax = {
            tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
            svg: {fontCache: 'global'}
        };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <link href="/static/notes_style.css" rel="stylesheet"/>
  <style>
   .interactive-demo {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border: 2px solid #3498db;
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
   }
   .demo-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
    margin-bottom: 20px;
   }
   .control-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
   }
   .control-group label {
    font-weight: bold;
    color: #2c3e50;
   }
   .control-group input, .control-group textarea {
    padding: 8px;
    border: 1px solid #bdc3c7;
    border-radius: 5px;
    font-size: 14px;
   }
   .control-group textarea {
    min-height: 60px;
    resize: vertical;
   }
   .demo-output {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin-top: 15px;
    border: 1px solid #ecf0f1;
   }
   .formula-block {
    background: #ecf0f1;
    border-left: 4px solid #3498db;
    padding: 15px;
    margin: 15px 0;
    font-family: 'Times New Roman', serif;
   }
   .practice-problem {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
   }
   .solution {
    background: #d4edda;
    border: 1px solid #c3e6cb;
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
    display: none;
   }
   .solution-button {
    background: #007bff;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
   }
   .solution-button:hover {
    background: #0056b3;
   }
   .key-takeaways {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
   }
   .key-takeaways h3 {
    margin-top: 0;
    color: white;
   }
   .key-takeaways ul {
    margin: 10px 0 0 0;
    padding-left: 20px;
   }
   .key-takeaways li {
    margin: 8px 0;
   }
   .worked-example {
    background: #e8f4f8;
    border: 1px solid #bee5eb;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
   }
   .worked-example h4 {
    margin-top: 0;
    color: #0c5460;
   }
   .math-foundation {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
   }
   .math-foundation h3 {
    margin-top: 0;
    color: #2c3e50;
   }
   .canvas-container {
    text-align: center;
    margin: 20px 0;
    position: relative;
   }
   .data-visualization {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
   }
   .sorted-data {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin: 20px 0;
   }
   .data-value {
    background: #3498db;
    color: white;
    padding: 8px 12px;
    border-radius: 5px;
    font-weight: bold;
    position: relative;
   }
   .median-highlight {
    background: #e74c3c !important;
    transform: scale(1.1);
   }
   .median-arrow {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    color: #e74c3c;
    font-weight: bold;
    font-size: 14px;
   }
   .position-indicator {
    display: flex;
    justify-content: center;
    margin: 10px 0;
    font-size: 14px;
    color: #666;
   }
   .position-number {
    display: inline-block;
    width: 30px;
    text-align: center;
    margin: 0 5px;
   }
   .diagram-row {
    display: flex;
    justify-content: space-around;
    margin: 20px 0;
    flex-wrap: wrap;
   }
   .diagram {
    background: white;
    border: 1px solid #ecf0f1;
    border-radius: 8px;
    padding: 15px;
    margin: 10px;
    text-align: center;
    min-width: 200px;
   }
   .diagram-title {
    font-weight: bold;
    margin-bottom: 10px;
    color: #2c3e50;
   }
   .dots {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin: 15px 0;
   }
   .dot {
    width: 20px;
    height: 20px;
    background: #3498db;
    border-radius: 50%;
    display: inline-block;
   }
   .dot.center {
    background: #e74c3c;
    transform: scale(1.2);
   }
   .dot.center2 {
    background: #e74c3c;
    transform: scale(1.2);
   }
   .arrow {
    color: #e74c3c;
    font-size: 20px;
    margin: 5px 0;
   }
   .diagram-desc {
    font-size: 12px;
    color: #666;
   }
   @media (max-width: 768px) {
    .demo-controls {
     flex-direction: column;
     align-items: stretch;
    }
    .control-group {
     width: 100%;
    }
    .diagram-row {
     flex-direction: column;
    }
   }
  </style>
 </head>
 <body>
  <div class="fancy-title" data-topic="Data Analysis">
   Median (中央値, メジアン)
  </div>
  <div class="container">
        <div class="main-content">

            <div class="math-foundation">
            <h3>Mathematical Foundation</h3>
            <p>The median is a robust measure of central tendency that represents the middle value in an ordered dataset. Unlike the mean, which uses all data values, the median depends only on the position of values in the ordered list. This makes it highly resistant to extreme values (outliers) and provides a better representation of the "typical" value when data contains anomalies or skewed distributions.</p>

            <div class="formula-block">
            <strong>Median Calculation:</strong>
            <ul>
            <li><strong>Odd number of data points (n odd):</strong> Median = value at position $\frac{n+1}{2}$</li>
            <li><strong>Even number of data points (n even):</strong> Median = average of values at positions $\frac{n}{2}$ and $\frac{n}{2} + 1$</li>
            <li><strong>Formula:</strong> $Median = \begin{cases} x_{\frac{n+1}{2}} & \text{if } n \text{ is odd} \\ \frac{x_{\frac{n}{2}} + x_{\frac{n}{2}+1}}{2} & \text{if } n \text{ is even} \end{cases}$</li>
            </ul>
            <strong>Where:</strong>
            <ul>
            <li>$n$ = number of data points</li>
            <li>$x_k$ = k-th value in ordered data</li>
            </ul>
            </div>
            </div>

            <div class="diagram-row">
            <div class="diagram">
            <div class="diagram-title">
            Odd Number of Data
            </div>
            <div class="dots">
            <span class="dot">
            </span>
            <span class="dot">
            </span>
            <span class="dot center">
            </span>
            <span class="dot">
            </span>
            <span class="dot">
            </span>
            </div>
            <div class="arrow">
            ↑
            </div>
            <div class="diagram-desc">
            Median (position (5+1)/2 = 3)
            </div>
            </div>
            <div class="diagram">
            <div class="diagram-title">
            Even Number of Data
            </div>
            <div class="dots">
            <span class="dot">
            </span>
            <span class="dot">
            </span>
            <span class="dot center2">
            </span>
            <span class="dot center2">
            </span>
            <span class="dot">
            </span>
            <span class="dot">
            </span>
            </div>
            <div class="arrow">
            ↑
            </div>
            <div class="diagram-desc">
            Average of positions n/2 and n/2+1
            </div>
            </div>
            </div>

            <div class="interactive-demo">
            <h3>Interactive Median Calculator</h3>
            <div class="demo-controls">
            <div class="control-group">
            <label for="data-input">Data Values (comma-separated):</label>
            <textarea id="data-input" placeholder="e.g., 5, 7, 3, 8, 12, 6">5, 7, 3, 8, 12, 6</textarea>
            </div>
            <button onclick="calculateMedian()" style="padding: 8px 16px; background: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer; align-self: flex-end;">Calculate Median</button>
            </div>

            <div class="data-visualization" id="data-viz">
            <h4>Data Visualization</h4>
            <div id="position-indicator" class="position-indicator"></div>
            <div id="sorted-data" class="sorted-data"></div>
            </div>

            <div class="demo-output" id="demo-output">
            <strong>Current Data:</strong> [5, 7, 3, 8, 12, 6]<br>
            <strong>Sorted Data:</strong> [3, 5, 6, 7, 8, 12]<br>
            <strong>Number of values:</strong> 6 (even)<br>
            <strong>Median position:</strong> 3rd and 4th values<br>
            <strong>Median:</strong> (6 + 7) / 2 = 6.5
            </div>
            </div>

            <div class="worked-example">
            <h4>Worked Example 1: Odd Number of Values</h4>
            <p>Find the median of: 12, 7, 15, 9, 21</p>
            <p><strong>Solution:</strong></p>
            <p>Step 1: Sort the data: 7, 9, 12, 15, 21</p>
            <p>Step 2: n = 5 (odd), so median position = (5+1)/2 = 3rd value</p>
            <p>Step 3: Median = 12</p>
            </div>

            <div class="worked-example">
            <h4>Worked Example 2: Even Number of Values</h4>
            <p>Find the median of: 8, 12, 15, 7, 10, 22</p>
            <p><strong>Solution:</strong></p>
            <p>Step 1: Sort the data: 7, 8, 10, 12, 15, 22</p>
            <p>Step 2: n = 6 (even), so median positions = 3rd and 4th values</p>
            <p>Step 3: Median = (10 + 12) / 2 = 11</p>
            </div>

            <div class="worked-example">
            <h4>Worked Example 3: Median with Outliers</h4>
            <p>Compare mean and median for: 2, 4, 6, 8, 100</p>
            <p><strong>Solution:</strong></p>
            <p>Sorted: 2, 4, 6, 8, 100</p>
            <p>Median = 6 (middle value)</p>
            <p>Mean = (2+4+6+8+100)/5 = 120/5 = 24</p>
            <p>The outlier (100) greatly affects the mean but not the median.</p>
            </div>

            <div style="margin: 30px 0;">
            <strong>Properties of the Median</strong>
            <ul>
            <li><strong>Robustness:</strong> Unlike the mean, the median is not affected by extreme values or outliers.</li>
            <li><strong>Position-based:</strong> The median depends only on the relative ordering of data, not on the actual values.</li>
            <li><strong>Break-even Point:</strong> In an ordered dataset, 50% of values are below the median and 50% are above it.</li>
            <li><strong>Geometric Interpretation:</strong> The median minimizes the sum of absolute deviations from any point.</li>
            </ul>
            </div>

            <div style="margin: 30px 0;">
            <strong>Median vs Mean: When to Use Each</strong>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 15px;">
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
            <h4 style="margin-top: 0; color: #27ae60;">Use Median When:</h4>
            <ul style="margin: 10px 0;">
                <li>Data contains outliers or extreme values</li>
                <li>Distribution is skewed</li>
                <li>Data is ordinal (rank-based)</li>
                <li>Robustness is important</li>
                <li>Income, property values, test scores with anomalies</li>
            </ul>
            </div>
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
            <h4 style="margin-top: 0; color: #3498db;">Use Mean When:</h4>
            <ul style="margin: 10px 0;">
                <li>All data points are equally important</li>
                <li>Mathematical calculations are needed</li>
                <li>Data is normally distributed</li>
                <li>Precision is more important than robustness</li>
                <li>Physical measurements, balanced data</li>
            </ul>
            </div>
            </div>
            </div>

            <h3>Practice Problems</h3>

            <div class="practice-problem">
            <strong>Problem 1:</strong> Find the median of: 15, 8, 12, 6, 19, 23, 10
            <br><button class="solution-button" onclick="toggleSolution(1)">Show Solution</button>
            <div class="solution" id="solution1">
            <strong>Solution:</strong><br>
            Sorted: 6, 8, 10, 12, 15, 19, 23<br>
            n = 7 (odd), median position = (7+1)/2 = 4th value<br>
            Median = 12
            </div>
            </div>

            <div class="practice-problem">
            <strong>Problem 2:</strong> Find the median of: 4, 7, 2, 9, 5, 8
            <br><button class="solution-button" onclick="toggleSolution(2)">Show Solution</button>
            <div class="solution" id="solution2">
            <strong>Solution:</strong><br>
            Sorted: 2, 4, 5, 7, 8, 9<br>
            n = 6 (even), median positions = 3rd and 4th values<br>
            Median = (5 + 7) / 2 = 6
            </div>
            </div>

            <div class="practice-problem">
            <strong>Problem 3:</strong> The median of 9 numbers is 25. What can you say about the numbers?
            <br><button class="solution-button" onclick="toggleSolution(3)">Show Solution</button>
            <div class="solution" id="solution3">
            <strong>Solution:</strong><br>
            For 9 numbers (odd), median is the 5th value when sorted<br>
            At least 5 numbers ≤ 25, and at least 5 numbers ≥ 25<br>
            At least 4 numbers ≤ 25, and at least 4 numbers ≥ 25
            </div>
            </div>

            <div class="practice-problem">
            <strong>Problem 4:</strong> Find the median of: 1, 3, 3, 3, 5, 7, 9
            <br><button class="solution-button" onclick="toggleSolution(4)">Show Solution</button>
            <div class="solution" id="solution4">
            <strong>Solution:</strong><br>
            Sorted: 1, 3, 3, 3, 5, 7, 9<br>
            n = 7 (odd), median position = 4th value<br>
            Median = 3
            </div>
            </div>

            <div class="practice-problem">
            <strong>Problem 5:</strong> Compare the mean and median of: 1, 2, 3, 4, 100
            <br><button class="solution-button" onclick="toggleSolution(5)">Show Solution</button>
            <div class="solution" id="solution5">
            <strong>Solution:</strong><br>
            Sorted: 1, 2, 3, 4, 100<br>
            Median = 3<br>
            Mean = (1+2+3+4+100)/5 = 110/5 = 22<br>
            The outlier (100) increases the mean but doesn't affect the median.
            </div>
            </div>

            <div class="key-takeaways">
            <h3>Key Takeaways</h3>
            <ul>
            <li><strong>Definition:</strong> The median is the middle value in an ordered dataset - 50% of values are below it, 50% are above it.</li>
            <li><strong>Calculation:</strong> For odd n: median = value at position (n+1)/2; For even n: median = average of values at positions n/2 and n/2+1.</li>
            <li><strong>Robustness:</strong> Unlike the mean, the median is resistant to extreme values and outliers.</li>
            <li><strong>Position-based:</strong> The median depends only on the ordering of data, not on the magnitude of values.</li>
            <li><strong>Applications:</strong> Preferred for skewed distributions, ordinal data, and when outliers are present (income, house prices, test scores).</li>
            <li><strong>Comparison with Mean:</strong> Mean uses all data points and is affected by outliers; median is robust but ignores the magnitude of non-central values.</li>
            <li><strong>Break-even Property:</strong> The median minimizes the sum of absolute deviations from any point in the dataset.</li>
            </ul>
            </div>

            <script>
            function calculateMedian() {
            const input = document.getElementById('data-input').value;
            const values = input.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));

            if (values.length === 0) {
            alert('Please enter valid numbers separated by commas.');
            return;
            }

            // Sort the values
            const sorted = [...values].sort((a, b) => a - b);
            let median;

            if (sorted.length % 2 === 1) {
            // Odd number of values
            const medianIndex = Math.floor(sorted.length / 2);
            median = sorted[medianIndex];
            } else {
            // Even number of values
            const mid1 = sorted[sorted.length / 2 - 1];
            const mid2 = sorted[sorted.length / 2];
            median = (mid1 + mid2) / 2;
            }

            // Update visualization
            updateVisualization(sorted, median);

            // Update output
            const output = document.getElementById('demo-output');
            const isEven = sorted.length % 2 === 0;
            const medianDesc = isEven
            ? `${sorted.length / 2}rd and ${sorted.length / 2 + 1}th values`
            : `${Math.floor(sorted.length / 2) + 1}th value`;

            output.innerHTML = `<strong>Current Data:</strong> [${values.join(', ')}]<br>
            <strong>Sorted Data:</strong> [${sorted.join(', ')}]<br>
            <strong>Number of values:</strong> ${sorted.length} (${isEven ? 'even' : 'odd'})<br>
            <strong>Median position:</strong> ${medianDesc}<br>
            <strong>Median:</strong> ${median}`;

            // Re-render MathJax
            if (window.MathJax) {
            MathJax.typesetPromise([output]).catch(function(err) {
                console.log('MathJax re-render error:', err);
            });
            }
            }

            function updateVisualization(sorted, median) {
            const container = document.getElementById('sorted-data');
            const positionIndicator = document.getElementById('position-indicator');

            // Clear previous content
            container.innerHTML = '';
            positionIndicator.innerHTML = '';

            // Create position indicators
            for (let i = 0; i < sorted.length; i++) {
            const pos = document.createElement('div');
            pos.className = 'position-number';
            pos.textContent = (i + 1);
            positionIndicator.appendChild(pos);
            }

            // Create data value elements
            sorted.forEach((value, index) => {
            const valueElement = document.createElement('div');
            valueElement.className = 'data-value';
            valueElement.textContent = value;

            // Highlight median values
            if (sorted.length % 2 === 1) {
                // Odd case - single median
                if (index === Math.floor(sorted.length / 2)) {
                valueElement.classList.add('median-highlight');
                const arrow = document.createElement('div');
                arrow.className = 'median-arrow';
                arrow.textContent = 'MEDIAN';
                valueElement.appendChild(arrow);
                }
            } else {
                // Even case - two middle values
                if (index === sorted.length / 2 - 1 || index === sorted.length / 2) {
                valueElement.classList.add('median-highlight');
                if (index === sorted.length / 2 - 1) {
                const arrow = document.createElement('div');
                arrow.className = 'median-arrow';
                arrow.textContent = 'MEDIAN';
                valueElement.appendChild(arrow);
                }
                }
            }

            container.appendChild(valueElement);
            });
            }

            function toggleSolution(num) {
            const solution = document.getElementById('solution' + num);
            if (solution.style.display === 'none' || solution.style.display === '') {
            solution.style.display = 'block';
            } else {
            solution.style.display = 'none';
            }
            }

            // Initialize with default data
            calculateMedian();
            </script>
        </div>
  </div>
 </body>
</html>
