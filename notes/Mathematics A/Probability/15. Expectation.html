<!DOCTYPE html>
<!-- tags: Probability -->
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Expectation (Expected Value)
  </title>
  <script>
   MathJax = {
            tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
            svg: {fontCache: 'global'}
        };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <link href="/static/notes_style.css" rel="stylesheet"/>
  <style>
   /* Enhanced text containment and scrolling */
   .container, .main-content, .section, .explain, .formula, .condition, .example, .application, .problem-item, .solution-content, .key-takeaways, .interactive-demo, .demo-result, .calculation-steps, .calculation-step, .rule-card, .visualization-container, .object-groups, .object-group, .identical-explanation, .expectation-explanation, .probability-table {
    word-wrap: break-word;
    overflow-wrap: break-word;
    overflow: auto;
   }
   
   /* Rule cards for formulas and concepts */
   .rule-card {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border: 2px solid #007acc;
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 4px 8px rgba(0, 122, 204, 0.1);
   }
   
   .rule-card h3 {
    color: #007acc;
    margin-top: 0;
    font-size: 1.3em;
   }
   
   .rule-card .formula {
    background: white;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #dee2e6;
    margin: 10px 0;
    font-size: 1.1em;
    text-align: center;
   }
   
   /* Expectation explanation */
   .expectation-explanation {
    background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
    border: 2px solid #ffc107;
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
   }
   
   .expectation-explanation h4 {
    color: #856404;
    margin-top: 0;
   }
   
   /* Probability table */
   .probability-table {
    background: white;
    border: 2px solid #007acc;
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
    overflow-x: auto;
   }
   
   .probability-table table {
    width: 100%;
    border-collapse: collapse;
    margin: 0;
   }
   
   .probability-table th, .probability-table td {
    border: 2px solid #007acc;
    padding: 12px;
    text-align: center;
    font-weight: bold;
   }
   
   .probability-table th {
    background: #007acc;
    color: white;
   }
   
   .probability-table .sumcell {
    background: #28a745;
    color: white;
   }
   
   /* Interactive demo styling */
   .interactive-demo {
    background: #f8f9fa;
    border: 2px solid #28a745;
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
   }
   
   .interactive-demo h3 {
    color: #28a745;
    margin-top: 0;
   }
   
   .demo-input {
    padding: 8px 12px;
    margin: 5px;
    border: 2px solid #28a745;
    border-radius: 6px;
    font-size: 16px;
    width: 100px;
   }
   
   .demo-button {
    background: #28a745;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    margin: 10px 0;
   }
   
   .demo-button:hover {
    background: #218838;
   }
   
   .demo-result {
    margin-top: 15px;
    padding: 10px;
    background: white;
    border-radius: 6px;
    border: 1px solid #dee2e6;
    font-size: 18px;
    font-weight: bold;
    text-align: center;
   }
   
   .highlight {
    color: #dc3545;
    font-size: 1.2em;
   }
   
   /* Problem items */
   .problem-item {
    background: white;
    border: 2px solid #ffc107;
    border-radius: 12px;
    padding: 20px;
    margin: 15px 0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
   }
   
   .problem-number {
    background: #ffc107;
    color: #000;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-right: 15px;
   }
   
   .problem-content {
    display: inline-block;
    width: calc(100% - 50px);
    vertical-align: top;
   }
   
   .solution-button {
    background: #007acc;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    margin: 10px 0;
   }
   
   .solution-button:hover {
    background: #0056b3;
   }
   
   .solution-content {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 6px;
    padding: 15px;
    margin-top: 10px;
   }
   
   /* Key takeaways */
   .key-takeaways {
    background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
    border: 2px solid #2196f3;
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
   }
   
   .key-takeaways h3 {
    color: #1976d2;
    margin-top: 0;
   }
   
   .key-takeaways ul {
    margin: 0;
   }
   
   .key-takeaways li {
    margin: 8px 0;
   }
   
   /* Calculation steps */
   .calculation-steps {
    background: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
   }
   
   .calculation-step {
    margin: 8px 0;
    padding: 5px 0;
    border-left: 3px solid #007acc;
    padding-left: 15px;
   }
   
   /* Visualization container */
   .visualization-container {
    text-align: center;
    margin: 20px 0;
   }
   
   .visualization-container canvas {
    border: 2px solid #007acc;
    border-radius: 8px;
    background: white;
   }
   
   /* Responsive design */
   @media (max-width: 768px) {
    .probability-table {
     font-size: 14px;
    }
    
    .problem-content {
     width: calc(100% - 50px);
    }
    
    .demo-input {
     width: 80px;
    }
   }
  </style>
 </head>
 <body>
  <div class="fancy-title" data-topic="Probability">
   Expectation (Expected Value)
  </div>
  <div class="container">
    <h1>15. Expectation (Expected Value)</h1>
    
    <div class="section">
      <h2>Core Concepts</h2>
      
      <div class="expectation-explanation">
        <h4>What is Expectation?</h4>
        <p>The <strong>expectation</strong> (or <strong>expected value</strong>) of a random variable is the long-run average value of the variable. It represents the center of mass of the probability distribution and is a measure of the "average" outcome we can expect from repeated trials of a random experiment.</p>
      </div>
      
      <div class="rule-card">
        <h3>Expectation Formula for Discrete Random Variables</h3>
        <div class="formula">
          \( E[X] = \sum_{i=1}^{n} x_i \cdot P(X = x_i) \)
        </div>
        <p>Where \( x_i \) are the possible values and \( P(X = x_i) \) are their probabilities.</p>
      </div>
      
      <div class="rule-card">
        <h3>Expectation Formula for Continuous Random Variables</h3>
        <div class="formula">
          \( E[X] = \int_{-\infty}^{\infty} x \cdot f(x) \, dx \)
        </div>
        <p>Where \( f(x) \) is the probability density function.</p>
      </div>
      
      <div class="rule-card">
        <h3>Properties of Expectation</h3>
        <div class="formula">
          \( E[aX + b] = aE[X] + b \)
        </div>
        <p>For constants a and b, the expectation scales linearly.</p>
      </div>
    </div>
    
    <div class="section">
      <h2>Visual Guide</h2>
      
      <div class="visualization-container">
        <canvas id="expectationCanvas" width="600" height="400"></canvas>
      </div>
      
      <p>The visualization above shows a probability distribution with its expected value marked. The expected value is the balance point of the distribution.</p>
    </div>
    
    <div class="section">
      <h2>Interactive Demo: Calculate Expectation</h2>
      
      <div class="interactive-demo">
        <h3>Expectation Calculator</h3>
        <p>Enter the values and their probabilities to calculate the expected value:</p>
        
        <div id="valueInputs">
          <div class="value-row">
            <label>Value 1: </label>
            <input type="number" class="demo-input value-input" step="0.01" placeholder="e.g., 1">
            <label>Probability: </label>
            <input type="number" class="demo-input prob-input" step="0.01" min="0" max="1" placeholder="e.g., 0.5">
            <button class="demo-button remove-value">Remove</button>
          </div>
        </div>
        
        <button class="demo-button" id="addValue">Add Value</button>
        <button class="demo-button" id="calculateExpectation">Calculate Expectation</button>
        
        <div class="demo-result" id="expectationResult">
          Expected Value: <span class="highlight">--</span>
        </div>
        
        <div class="calculation-steps" id="calculationSteps">
          <strong>Calculation Steps:</strong>
        </div>
      </div>
    </div>
    
    <div class="section">
      <h2>Detailed Examples</h2>
      
      <div class="example">
        <h3>Example 1: Fair Die Roll</h3>
        <p>A fair six-sided die is rolled. What is the expected value of the number showing?</p>
        
        <div class="probability-table">
          <table>
            <tr>
              <th>Outcome (x)</th>
              <th>1</th>
              <th>2</th>
              <th>3</th>
              <th>4</th>
              <th>5</th>
              <th>6</th>
            </tr>
            <tr>
              <td>Probability P(X=x)</td>
              <td>1/6</td>
              <td>1/6</td>
              <td>1/6</td>
              <td>1/6</td>
              <td>1/6</td>
              <td>1/6</td>
            </tr>
          </table>
        </div>
        
        <div class="calculation-steps">
          <div class="calculation-step">
            \( E[X] = 1 \cdot \frac{1}{6} + 2 \cdot \frac{1}{6} + 3 \cdot \frac{1}{6} + 4 \cdot \frac{1}{6} + 5 \cdot \frac{1}{6} + 6 \cdot \frac{1}{6} \)
          </div>
          <div class="calculation-step">
            \( E[X] = \frac{1+2+3+4+5+6}{6} = \frac{21}{6} = 3.5 \)
          </div>
        </div>
        
        <p><strong>Result:</strong> The expected value is 3.5</p>
      </div>
      
      <div class="example">
        <h3>Example 2: Coin Flip Game</h3>
        <p>You pay $2 to play a game where you flip a fair coin. If heads, you win $5. If tails, you win nothing. What is your expected winnings?</p>
        
        <div class="probability-table">
          <table>
            <tr>
              <th>Outcome</th>
              <th>Heads</th>
              <th>Tails</th>
            </tr>
            <tr>
              <td>Winnings (X)</td>
              <td>$5</td>
              <td>$0</td>
            </tr>
            <tr>
              <td>Probability</td>
              <td>0.5</td>
              <td>0.5</td>
            </tr>
          </table>
        </div>
        
        <div class="calculation-steps">
          <div class="calculation-step">
            \( E[X] = 5 \cdot 0.5 + 0 \cdot 0.5 = 2.5 \)
          </div>
        </div>
        
        <p><strong>Result:</strong> Expected winnings = $2.50. Since you paid $2, your expected profit is $0.50.</p>
      </div>
      
      <div class="example">
        <h3>Example 3: Insurance Premium</h3>
        <p>An insurance company charges $200 annual premium for a policy that pays $10,000 if your house burns down. The probability of fire is 0.001. What is the expected profit for the insurance company?</p>
        
        <div class="calculation-steps">
          <div class="calculation-step">
            Let X = profit for insurance company
          </div>
          <div class="calculation-step">
            If no fire: X = $200 (premium collected)
          </div>
          <div class="calculation-step">
            If fire: X = $200 - $10,000 = -$9,800 (premium - payout)
          </div>
          <div class="calculation-step">
            \( E[X] = 200 \cdot (1 - 0.001) + (-9800) \cdot 0.001 \)
          </div>
          <div class="calculation-step">
            \( E[X] = 200 \cdot 0.999 + (-9800) \cdot 0.001 = 199.8 - 9.8 = 190 \)
          </div>
        </div>
        
        <p><strong>Result:</strong> Expected profit = $190 per policy</p>
      </div>
    </div>
    
    <div class="section">
      <h2>Applications</h2>
      
      <div class="application">
        <h3>Financial Decision Making</h3>
        <p>Expected value helps investors evaluate the potential return of investments and make informed decisions about risk vs. reward.</p>
      </div>
      
      <div class="application">
        <h3>Insurance Pricing</h3>
        <p>Insurance companies use expected value to set premiums that ensure profitability while remaining competitive.</p>
      </div>
      
      <div class="application">
        <h3>Quality Control</h3>
        <p>Manufacturers use expected value to determine the cost-effectiveness of quality control procedures and defect prevention measures.</p>
      </div>
      
      <div class="application">
        <h3>Game Theory</h3>
        <p>In game theory, expected value helps players choose optimal strategies by calculating the average payoff of different actions.</p>
      </div>
    </div>
    
    <div class="section">
      <h2>Practice Problems</h2>
      
      <div class="problem-item">
        <div class="problem-number">1</div>
        <div class="problem-content">
          <p>A lottery ticket costs $1. The prize is $100 with probability 0.001, $10 with probability 0.01, and $0 otherwise. What is the expected value of playing this lottery?</p>
          <button class="solution-button" onclick="toggleSolution(1)">Show Solution</button>
          <div class="solution-content" id="solution1" style="display: none;">
            <div class="calculation-steps">
              <div class="calculation-step">\( E[X] = 100 \cdot 0.001 + 10 \cdot 0.01 + 0 \cdot 0.989 \)</div>
              <div class="calculation-step">\( E[X] = 0.1 + 0.1 + 0 = 0.2 \)</div>
            </div>
            <p><strong>Answer:</strong> Expected value = $0.20</p>
          </div>
        </div>
      </div>
      
      <div class="problem-item">
        <div class="problem-number">2</div>
        <div class="problem-content">
          <p>You roll two fair dice and win the sum of the numbers showing. What is the expected value of your winnings?</p>
          <button class="solution-button" onclick="toggleSolution(2)">Show Solution</button>
          <div class="solution-content" id="solution2" style="display: none;">
            <p>The possible sums range from 2 to 12. Each sum has different probabilities.</p>
            <div class="calculation-steps">
              <div class="calculation-step">\( E[X] = \sum_{k=2}^{12} k \cdot P(X = k) \)</div>
              <div class="calculation-step">This requires calculating each probability, but we know E[X] = E[X₁] + E[X₂] = 3.5 + 3.5 = 7</div>
            </div>
            <p><strong>Answer:</strong> Expected value = 7</p>
          </div>
        </div>
      </div>
      
      <div class="problem-item">
        <div class="problem-number">3</div>
        <div class="problem-content">
          <p>A company produces items with a defect rate of 5%. The cost of inspecting each item is $0.10, and the cost of a defective item reaching the customer is $5. Should they inspect all items?</p>
          <button class="solution-button" onclick="toggleSolution(3)">Show Solution</button>
          <div class="solution-content" id="solution3" style="display: none;">
            <p>Expected cost without inspection: 0.05 × $5 = $0.25 per item</p>
            <p>Cost with inspection: $0.10 per item</p>
            <p>Since $0.10 > $0.25, they should not inspect all items.</p>
            <p><strong>Answer:</strong> No, the expected cost of not inspecting ($0.25) is less than the inspection cost ($0.10).</p>
          </div>
        </div>
      </div>
      
      <div class="problem-item">
        <div class="problem-number">4</div>
        <div class="problem-content">
          <p>You have a choice between two games:</p>
          <p>Game A: Win $1000 with probability 0.1, lose $100 with probability 0.9</p>
          <p>Game B: Win $100 with probability 0.5, lose $50 with probability 0.5</p>
          <p>Which game has higher expected value?</p>
          <button class="solution-button" onclick="toggleSolution(4)">Show Solution</button>
          <div class="solution-content" id="solution4" style="display: none;">
            <div class="calculation-steps">
              <div class="calculation-step">Game A: \( E[X] = 1000 \cdot 0.1 + (-100) \cdot 0.9 = 100 - 90 = 10 \)</div>
              <div class="calculation-step">Game B: \( E[X] = 100 \cdot 0.5 + (-50) \cdot 0.5 = 50 - 25 = 25 \)</div>
            </div>
            <p><strong>Answer:</strong> Game B has higher expected value ($25 vs $10)</p>
          </div>
        </div>
      </div>
      
      <div class="problem-item">
        <div class="problem-number">5</div>
        <div class="problem-content">
          <p>A stock has a 60% chance of increasing by 20% and a 40% chance of decreasing by 10%. What is the expected percentage return?</p>
          <button class="solution-button" onclick="toggleSolution(5)">Show Solution</button>
          <div class="solution-content" id="solution5" style="display: none;">
            <div class="calculation-steps">
              <div class="calculation-step">\( E[X] = 20\% \cdot 0.6 + (-10\%) \cdot 0.4 = 12\% - 4\% = 8\% \)</div>
            </div>
            <p><strong>Answer:</strong> Expected return = 8%</p>
          </div>
        </div>
      </div>
    </div>
    
    <div class="key-takeaways">
      <h3>Key Takeaways</h3>
      <ul>
        <li><strong>Definition:</strong> Expected value is the long-run average of a random variable over many trials.</li>
        <li><strong>Formula:</strong> For discrete variables, multiply each outcome by its probability and sum them up.</li>
        <li><strong>Linearity:</strong> E[aX + b] = aE[X] + b for constants a and b.</li>
        <li><strong>Interpretation:</strong> Expected value represents the "center of mass" of the probability distribution.</li>
        <li><strong>Decision Making:</strong> Expected value helps compare different options and make rational choices under uncertainty.</li>
        <li><strong>Applications:</strong> Used in finance, insurance, quality control, and game theory for optimal decision making.</li>
        <li><strong>Caveat:</strong> Expected value doesn't capture risk - two distributions can have the same expected value but different risk levels.</li>
      </ul>
    </div>
  </div>

  <script>
    // Expectation visualization
    const canvas = document.getElementById('expectationCanvas');
    const ctx = canvas.getContext('2d');
    
    function drawExpectationVisualization() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Draw probability distribution bars
      const values = [1, 2, 3, 4, 5, 6];
      const probs = [1/6, 1/6, 1/6, 1/6, 1/6, 1/6];
      const barWidth = 60;
      const maxHeight = 200;
      
      ctx.fillStyle = '#007acc';
      values.forEach((val, i) => {
        const height = probs[i] * maxHeight;
        const x = 50 + i * (barWidth + 10);
        const y = canvas.height - 50 - height;
        
        ctx.fillRect(x, y, barWidth, height);
        
        // Label bars
        ctx.fillStyle = '#000';
        ctx.font = '14px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(val.toString(), x + barWidth/2, canvas.height - 25);
        ctx.fillText((probs[i]*100).toFixed(0) + '%', x + barWidth/2, y - 10);
        ctx.fillStyle = '#007acc';
      });
      
      // Draw expected value line
      const expectedValue = 3.5;
      const expectedX = 50 + (expectedValue - 1) * (barWidth + 10) + barWidth/2;
      
      ctx.strokeStyle = '#dc3545';
      ctx.lineWidth = 3;
      ctx.beginPath();
      ctx.moveTo(expectedX, 50);
      ctx.lineTo(expectedX, canvas.height - 50);
      ctx.stroke();
      
      // Label expected value
      ctx.fillStyle = '#dc3545';
      ctx.font = '16px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('Expected Value = 3.5', expectedX, 30);
    }
    
    drawExpectationVisualization();
    
    // Interactive expectation calculator
    let valueCount = 1;
    
    document.getElementById('addValue').addEventListener('click', function() {
      valueCount++;
      const valueInputs = document.getElementById('valueInputs');
      const newRow = document.createElement('div');
      newRow.className = 'value-row';
      newRow.innerHTML = `
        <label>Value ${valueCount}: </label>
        <input type="number" class="demo-input value-input" step="0.01" placeholder="e.g., ${valueCount}">
        <label>Probability: </label>
        <input type="number" class="demo-input prob-input" step="0.01" min="0" max="1" placeholder="e.g., 0.${Math.floor(Math.random() * 9) + 1}">
        <button class="demo-button remove-value">Remove</button>
      `;
      valueInputs.appendChild(newRow);
      
      // Add remove functionality
      newRow.querySelector('.remove-value').addEventListener('click', function() {
        valueInputs.removeChild(newRow);
        valueCount--;
        updateValueLabels();
      });
      
      updateValueLabels();
    });
    
    function updateValueLabels() {
      const rows = document.querySelectorAll('.value-row');
      rows.forEach((row, index) => {
        const label = row.querySelector('label');
        label.textContent = `Value ${index + 1}: `;
      });
    }
    
    document.getElementById('calculateExpectation').addEventListener('click', function() {
      const valueInputs = document.querySelectorAll('.value-input');
      const probInputs = document.querySelectorAll('.prob-input');
      const resultDiv = document.getElementById('expectationResult');
      const stepsDiv = document.getElementById('calculationSteps');
      
      let expectation = 0;
      let totalProb = 0;
      let steps = '<strong>Calculation Steps:</strong><br>';
      
      for (let i = 0; i < valueInputs.length; i++) {
        const value = parseFloat(valueInputs[i].value) || 0;
        const prob = parseFloat(probInputs[i].value) || 0;
        
        expectation += value * prob;
        totalProb += prob;
        
        if (i > 0) steps += ' + ';
        steps += `${value} × ${prob}`;
      }
      
      steps += ` = ${expectation.toFixed(3)}`;
      
      if (Math.abs(totalProb - 1) > 0.001) {
        resultDiv.innerHTML = 'Expected Value: <span class="highlight">Error: Probabilities must sum to 1</span>';
        stepsDiv.innerHTML = '<strong>Calculation Steps:</strong> Total probability = ' + totalProb.toFixed(3) + ' (should be 1.0)';
      } else {
        resultDiv.innerHTML = 'Expected Value: <span class="highlight">' + expectation.toFixed(3) + '</span>';
        stepsDiv.innerHTML = steps;
      }
    });
    
    // Solution toggle function
    function toggleSolution(problemNumber) {
      const solution = document.getElementById('solution' + problemNumber);
      const button = solution.previousElementSibling;
      
      if (solution.style.display === 'none') {
        solution.style.display = 'block';
        button.textContent = 'Hide Solution';
      } else {
        solution.style.display = 'none';
        button.textContent = 'Show Solution';
      }
    }
  </script>
 </body>
</html>
