<!DOCTYPE html>
<!-- tags: Polar Coordinates, Cartesian Coordinates, Geometry -->
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Polar and Cartesian Coordinates
  </title>
  <script>
   MathJax = {
            tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
            svg: {fontCache: 'global'}
        };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <link href="/static/notes_style.css" rel="stylesheet"/>
  <style>
    /* Enhanced text containment and readability */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      word-wrap: break-word;
      overflow-wrap: break-word;
      hyphens: auto;
    }

    .main-content {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      border-radius: 15px;
      padding: 30px;
      margin: 20px 0;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      border: 1px solid rgba(255,255,255,0.2);
    }

    .section {
      margin-bottom: 40px;
      background: rgba(255,255,255,0.9);
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .section h2 {
      color: #2c3e50;
      border-bottom: 3px solid #3498db;
      padding-bottom: 10px;
      margin-bottom: 20px;
      font-size: 1.8em;
      font-weight: 600;
    }

    .section h3 {
      color: #34495e;
      margin-bottom: 15px;
      font-size: 1.4em;
      font-weight: 500;
    }

    /* Law blocks with gradient backgrounds */
    .law-block {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      color: white;
      box-shadow: 0 4px 15px rgba(102,126,234,0.3);
    }

    .law-eq {
      font-size: 1.2em;
      font-weight: bold;
      margin-bottom: 15px;
      text-align: center;
      border-bottom: 2px solid rgba(255,255,255,0.3);
      padding-bottom: 10px;
    }

    .law-block .math {
      margin: 8px 0;
      font-size: 1.1em;
      line-height: 1.6;
    }

    /* Operation blocks */
    .operation-block {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      color: white;
      box-shadow: 0 4px 15px rgba(245,87,108,0.3);
    }

    .operation-block .formula {
      background: rgba(255,255,255,0.9);
      color: #333;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
      font-size: 1.3em;
      font-weight: bold;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    /* Hint blocks */
    .hint-block {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      color: white;
      box-shadow: 0 4px 15px rgba(79,172,254,0.3);
    }

    .hint-block strong {
      font-size: 1.2em;
      display: block;
      margin-bottom: 15px;
      text-align: center;
      border-bottom: 2px solid rgba(255,255,255,0.3);
      padding-bottom: 10px;
    }

    /* Interactive demo styling */
    .interactive-demo {
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      border-radius: 12px;
      padding: 25px;
      margin: 25px 0;
      box-shadow: 0 4px 15px rgba(168,237,234,0.3);
    }

    .interactive-demo h3 {
      color: #2c3e50;
      margin-bottom: 20px;
      text-align: center;
      font-size: 1.5em;
    }

    .demo-input {
      width: 80px;
      padding: 8px 12px;
      border: 2px solid #3498db;
      border-radius: 6px;
      font-size: 1em;
      margin: 0 5px;
      background: rgba(255,255,255,0.9);
      color: #333;
    }

    .demo-input:focus {
      outline: none;
      border-color: #2980b9;
      box-shadow: 0 0 5px rgba(52,152,219,0.5);
    }

    .demo-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      margin: 5px;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(102,126,234,0.3);
    }

    .demo-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(102,126,234,0.4);
    }

    .demo-result {
      background: rgba(255,255,255,0.9);
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
      font-family: 'Courier New', monospace;
      font-size: 1em;
      color: #333;
      white-space: pre-line;
      border: 1px solid #ddd;
      min-height: 40px;
    }

    /* Problem items */
    .problem-item {
      background: rgba(255,255,255,0.95);
      border-radius: 10px;
      padding: 20px;
      margin: 15px 0;
      border-left: 5px solid #3498db;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .problem-number {
      display: inline-block;
      background: #3498db;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      text-align: center;
      line-height: 30px;
      font-weight: bold;
      margin-right: 15px;
      vertical-align: top;
    }

    .problem-content {
      display: inline-block;
      width: calc(100% - 50px);
      vertical-align: top;
    }

    .solution-button {
      background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
      color: #333;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9em;
      margin: 10px 0;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(255,154,158,0.3);
    }

    .solution-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 3px 12px rgba(255,154,158,0.4);
    }

    .solution-content {
      display: none;
      margin-top: 15px;
      padding: 15px;
      background: rgba(240,240,240,0.8);
      border-radius: 8px;
      border: 1px solid #ddd;
    }

    .calculation-steps {
      margin: 10px 0;
    }

    .calculation-step {
      margin: 8px 0;
      padding: 8px 12px;
      background: rgba(255,255,255,0.7);
      border-radius: 6px;
      border-left: 3px solid #3498db;
    }

    /* Key takeaways */
    .key-takeaways {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 12px;
      padding: 25px;
      margin: 25px 0;
      color: white;
      box-shadow: 0 4px 15px rgba(102,126,234,0.3);
    }

    .key-takeaways h3 {
      text-align: center;
      font-size: 1.5em;
      margin-bottom: 20px;
      border-bottom: 2px solid rgba(255,255,255,0.3);
      padding-bottom: 10px;
    }

    .key-takeaways ul {
      list-style: none;
      padding: 0;
    }

    .key-takeaways li {
      margin: 10px 0;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }

    .key-takeaways li:last-child {
      border-bottom: none;
    }

    /* Enhanced canvas styling */
    .coordinate-canvas {
      display: block;
      margin: 20px auto;
      border: 2px solid #3498db;
      border-radius: 8px;
      background: white;
      box-shadow: 0 4px 15px rgba(52,152,219,0.2);
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }

      .main-content {
        padding: 20px;
      }

      .section {
        padding: 15px;
      }

      .interactive-demo {
        padding: 15px;
      }

      .demo-input {
        width: 60px;
        margin: 5px;
      }

      .demo-button {
        display: block;
        width: 100%;
        margin: 5px 0;
      }

      .problem-content {
        width: calc(100% - 40px);
      }
    }

    /* MathJax styling */
    .mjx-chtml {
      font-size: 1.1em !important;
    }

    /* Formula boxes */
    .formula-box {
      background: rgba(255,255,255,0.9);
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      text-align: center;
      font-size: 1.2em;
      font-weight: bold;
      color: #333;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    /* Property lists */
    .property-list {
      background: rgba(255,255,255,0.9);
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      color: #333;
    }

    .property-list li {
      margin: 8px 0;
      padding: 5px 0;
      border-bottom: 1px solid #eee;
    }

    .property-list li:last-child {
      border-bottom: none;
    }

    /* Coordinate system styling */
    .cartesian-coords {
      color: #27ae60;
      font-weight: bold;
      background: rgba(39,174,96,0.1);
      padding: 2px 6px;
      border-radius: 4px;
    }

    .polar-coords {
      color: #e74c3c;
      font-weight: bold;
      background: rgba(231,76,60,0.1);
      padding: 2px 6px;
      border-radius: 4px;
    }

    .coord-system {
      display: inline-block;
      padding: 10px;
      margin: 10px;
      border-radius: 8px;
      min-width: 200px;
      text-align: center;
    }

    .cartesian-system {
      background: linear-gradient(135deg, #a8e6cf 0%, #dcedc8 100%);
      border: 2px solid #27ae60;
    }

    .polar-system {
      background: linear-gradient(135deg, #ffd3a5 0%, #fdffb6 100%);
      border: 2px solid #e74c3c;
    }
  </style>
 </head>
 <body>
  <div class="fancy-title" data-topic="Polar Coordinates, Cartesian Coordinates, Geometry">
   Polar and Cartesian Coordinates
  </div>
  <div class="container">
   <div class="main-content">

    <!-- Mathematical Foundation -->
    <div class="section">
     <h2>Mathematical Foundation</h2>

     <div class="hint-block">
      <strong>Coordinate Systems Overview</strong>
      <p>Two primary coordinate systems are used to locate points in a plane: the Cartesian (rectangular) coordinate system and the polar coordinate system. Each has its advantages depending on the problem being solved.</p>
     </div>

     <div style="display: flex; justify-content: space-around; margin: 20px 0;">
      <div class="coord-system cartesian-system">
       <h4 class="cartesian-coords">Cartesian Coordinates</h4>
       <p>Point P: (x, y)</p>
       <p>Uses perpendicular axes</p>
       <p>Origin at (0, 0)</p>
       <p>Best for: Linear relationships, rectangular grids</p>
      </div>

      <div class="coord-system polar-system">
       <h4 class="polar-coords">Polar Coordinates</h4>
       <p>Point P: (r, θ)</p>
       <p>Uses distance and angle</p>
       <p>Pole at origin</p>
       <p>Best for: Circular motion, periodic functions</p>
      </div>
     </div>

     <div class="law-block">
      <div class="law-eq">Coordinate Conversion Formulas</div>
      <div class="math">
       <strong>Cartesian to Polar:</strong>
      </div>
      <div class="math">
       \( r = \sqrt{x^2 + y^2} \)
      </div>
      <div class="math">
       \( \theta = \tan^{-1}\left(\dfrac{y}{x}\right) \) (adjusted for quadrant)
      </div>
      <br>
      <div class="math">
       <strong>Polar to Cartesian:</strong>
      </div>
      <div class="math">
       \( x = r \cos \theta \)
      </div>
      <div class="math">
       \( y = r \sin \theta \)
      </div>
     </div>

     <div class="operation-block">
      <div class="formula">
       Important Notes on θ (Angle)
      </div>
      <ul style="color: white; margin: 15px 0;">
       <li>θ is measured counterclockwise from the positive x-axis</li>
       <li>θ ranges from 0 to 2π radians (or 0° to 360°)</li>
       <li>r ≥ 0 (distance is always positive)</li>
       <li>θ is undefined when r = 0 (origin point)</li>
       <li>θ + 2πk gives the same point for any integer k</li>
      </ul>
     </div>
    </div>

    <!-- Interactive Coordinate Converter -->
    <div class="section">
     <h2>Interactive Coordinate Converter</h2>

     <div class="interactive-demo">
      <h3>Coordinate System Converter</h3>

      <div style="display: flex; justify-content: space-around; margin: 20px 0;">
       <div style="text-align: center;">
        <h4 class="cartesian-coords">Cartesian → Polar</h4>
        <div style="margin: 15px 0;">
         <label>x: <input type="number" id="cart-x" class="demo-input" value="3" step="0.1"></label>
         <label>y: <input type="number" id="cart-y" class="demo-input" value="4" step="0.1"></label>
        </div>
        <button class="demo-button" onclick="convertCartesianToPolar()">Convert to Polar</button>
       </div>

       <div style="text-align: center;">
        <h4 class="polar-coords">Polar → Cartesian</h4>
        <div style="margin: 15px 0;">
         <label>r: <input type="number" id="polar-r" class="demo-input" value="5" step="0.1" min="0"></label>
         <label>θ: <input type="number" id="polar-theta" class="demo-input" value="0.927" step="0.001"></label>
        </div>
        <button class="demo-button" onclick="convertPolarToCartesian()">Convert to Cartesian</button>
       </div>
      </div>

      <canvas id="coordinate-canvas" width="600" height="400" class="coordinate-canvas"></canvas>

      <div class="demo-result" id="conversion-result">
       Cartesian: (3, 4) → Polar: (5, 0.927 rad) or (5, 53.13°)<br>
       Polar: (5, 0.927) → Cartesian: (3, 4)
      </div>
     </div>
    </div>

    <!-- Worked Examples -->
    <div class="section">
     <h2>Worked Examples</h2>

     <div class="problem-item">
      <div class="problem-number">1</div>
      <div class="problem-content">
       <strong>Problem:</strong> Convert the Cartesian point (4, -3) to polar coordinates.
       <br><br>
       <button class="solution-button" onclick="toggleSolution('sol1')">Show Solution</button>
       <div class="solution-content" id="sol1">
        <div class="calculation-steps">
         <div class="calculation-step">
          <strong>Step 1:</strong> Calculate r (distance from origin)
          <br>\( r = \sqrt{x^2 + y^2} = \sqrt{4^2 + (-3)^2} = \sqrt{16 + 9} = \sqrt{25} = 5 \)
         </div>
         <div class="calculation-step">
          <strong>Step 2:</strong> Calculate θ (angle from positive x-axis)
          <br>\( \theta = \tan^{-1}\left(\dfrac{y}{x}\right) = \tan^{-1}\left(\dfrac{-3}{4}\right) = \tan^{-1}(-0.75) \)
          <br>Since the point is in the fourth quadrant (x > 0, y < 0), θ = -0.6435 radians or -36.87°
         </div>
         <div class="calculation-step">
          <strong>Step 3:</strong> Express in standard polar form
          <br>Principal value: (5, -0.6435) or (5, -36.87°)
          <br>Equivalent positive angle: (5, 5.6397) or (5, 323.13°)
         </div>
         <div class="calculation-step">
          <strong>Answer:</strong> \( \left(5, -\dfrac{\pi}{5}\right) \) or \( \left(5, -36.87^\circ\right) \)
         </div>
        </div>
       </div>
      </div>
     </div>

     <div class="problem-item">
      <div class="problem-number">2</div>
      <div class="problem-content">
       <strong>Problem:</strong> Convert the polar point \( \left(6, \dfrac{2\pi}{3}\right) \) to Cartesian coordinates.
       <br><br>
       <button class="solution-button" onclick="toggleSolution('sol2')">Show Solution</button>
       <div class="solution-content" id="sol2">
        <div class="calculation-steps">
         <div class="calculation-step">
          <strong>Step 1:</strong> Calculate x-coordinate
          <br>\( x = r \cos \theta = 6 \cos\left(\dfrac{2\pi}{3}\right) = 6 \times \left(-\dfrac{1}{2}\right) = -3 \)
         </div>
         <div class="calculation-step">
          <strong>Step 2:</strong> Calculate y-coordinate
          <br>\( y = r \sin \theta = 6 \sin\left(\dfrac{2\pi}{3}\right) = 6 \times \dfrac{\sqrt{3}}{2} = 3\sqrt{3} \approx 5.196 \)
         </div>
         <div class="calculation-step">
          <strong>Answer:</strong> \( \left(-3, 3\sqrt{3}\right) \)
         </div>
        </div>
       </div>
      </div>
     </div>

     <div class="problem-item">
      <div class="problem-number">3</div>
      <div class="problem-content">
       <strong>Problem:</strong> Find all polar representations of the point (-2, 2).
       <br><br>
       <button class="solution-button" onclick="toggleSolution('sol3')">Show Solution</button>
       <div class="solution-content" id="sol3">
        <div class="calculation-steps">
         <div class="calculation-step">
          <strong>Step 1:</strong> Calculate r
          <br>\( r = \sqrt{(-2)^2 + 2^2} = \sqrt{4 + 4} = \sqrt{8} = 2\sqrt{2} \approx 2.828 \)
         </div>
         <div class="calculation-step">
          <strong>Step 2:</strong> Calculate principal angle θ
          <br>\( \theta = \tan^{-1}\left(\dfrac{2}{-2}\right) = \tan^{-1}(-1) = -\dfrac{\pi}{4} \) (fourth quadrant)
         </div>
         <div class="calculation-step">
          <strong>Step 3:</strong> Find coterminal angles
          <br>\( \theta + 2\pi k \) for integer k
          <br>k = 0: \( -\dfrac{\pi}{4} \approx -0.785 \) rad
          <br>k = 1: \( -\dfrac{\pi}{4} + 2\pi = \dfrac{7\pi}{4} \approx 5.498 \) rad
          <br>k = -1: \( -\dfrac{\pi}{4} - 2\pi = -\dfrac{9\pi}{4} \approx -7.068 \) rad
         </div>
         <div class="calculation-step">
          <strong>Answer:</strong> \( \left(2\sqrt{2}, -\dfrac{\pi}{4} + 2\pi k\right) \) for any integer k
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>

    <!-- Applications -->
    <div class="section">
     <h2>Applications</h2>

     <h3>Physics and Engineering</h3>
     <div class="property-list">
      <li><strong>Circular Motion:</strong> Polar coordinates naturally describe objects moving in circles</li>
      <li><strong>Wave Phenomena:</strong> Sound waves, light waves, and electromagnetic fields</li>
      <li><strong>Robotics:</strong> Robot arm positioning and navigation systems</li>
      <li><strong>Radar Systems:</strong> Distance and direction measurements</li>
     </div>

     <h3>Mathematics</h3>
     <div class="property-list">
      <li><strong>Complex Numbers:</strong> Polar form is essential for complex number operations</li>
      <li><strong>Calculus:</strong> Integration in polar coordinates for area calculations</li>
      <li><strong>Conic Sections:</strong> Polar equations often simplify conic section representations</li>
      <li><strong>Fourier Analysis:</strong> Frequency domain representations</li>
     </div>

     <div class="hint-block">
      <strong>When to Use Each System</strong>
      <p><span class="cartesian-coords">Cartesian coordinates</span> are better for problems involving straight lines, rectangular regions, and linear relationships. <span class="polar-coords">Polar coordinates</span> excel with circles, spirals, periodic functions, and problems with rotational symmetry.</p>
     </div>
    </div>

    <!-- Practice Problems -->
    <div class="section">
     <h2>Practice Problems</h2>

     <div class="problem-item">
      <div class="problem-number">1</div>
      <div class="problem-content">
       Convert (5, 12) to polar coordinates.
       <br><br>
       <button class="solution-button" onclick="toggleSolution('prac1')">Show Solution</button>
       <div class="solution-content" id="prac1">
        <div class="calculation-steps">
         <div class="calculation-step">
          \( r = \sqrt{5^2 + 12^2} = \sqrt{25 + 144} = \sqrt{169} = 13 \)
         </div>
         <div class="calculation-step">
          \( \theta = \tan^{-1}\left(\dfrac{12}{5}\right) = \tan^{-1}(2.4) \approx 1.176 \) rad or 67.38°
         </div>
        </div>
       </div>
      </div>
     </div>

     <div class="problem-item">
      <div class="problem-number">2</div>
      <div class="problem-content">
       Convert \( \left(4, \dfrac{\pi}{6}\right) \) to Cartesian coordinates.
       <br><br>
       <button class="solution-button" onclick="toggleSolution('prac2')">Show Solution</button>
       <div class="solution-content" id="prac2">
        <div class="calculation-steps">
         <div class="calculation-step">
          \( x = 4 \cos\left(\dfrac{\pi}{6}\right) = 4 \times \dfrac{\sqrt{3}}{2} = 2\sqrt{3} \approx 3.464 \)
         </div>
         <div class="calculation-step">
          \( y = 4 \sin\left(\dfrac{\pi}{6}\right) = 4 \times \dfrac{1}{2} = 2 \)
         </div>
        </div>
       </div>
      </div>
     </div>

     <div class="problem-item">
      <div class="problem-number">3</div>
      <div class="problem-content">
       Find the distance between points (3, 4) and (0, 0) in both coordinate systems.
       <br><br>
       <button class="solution-button" onclick="toggleSolution('prac3')">Show Solution</button>
       <div class="solution-content" id="prac3">
        <div class="calculation-steps">
         <div class="calculation-step">
          <strong>Cartesian:</strong> \( d = \sqrt{(3-0)^2 + (4-0)^2} = \sqrt{9 + 16} = \sqrt{25} = 5 \)
         </div>
         <div class="calculation-step">
          <strong>Polar:</strong> The point (3, 4) in polar is (5, θ), so distance is simply r = 5
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>

    <!-- Key Takeaways -->
    <div class="key-takeaways">
     <h3>Key Takeaways</h3>
     <ul>
      <li><span class="cartesian-coords">Cartesian (x, y):</span> Uses perpendicular axes, best for linear relationships</li>
      <li><span class="polar-coords">Polar (r, θ):</span> Uses distance and angle, best for circular motion</li>
      <li>Conversion formulas: \( x = r\cos\theta \), \( y = r\sin\theta \), \( r = \sqrt{x^2+y^2} \), \( \theta = \tan^{-1}(y/x) \)</li>
      <li>θ is measured counterclockwise from positive x-axis, ranges from 0 to 2π</li>
      <li>Multiple polar representations exist for the same point (θ + 2πk)</li>
      <li>Choose coordinate system based on problem symmetry and convenience</li>
      <li>Applications in physics, engineering, complex numbers, and calculus</li>
     </ul>
    </div>

   </div>
  </div>

  <script>
   // Interactive Coordinate Converter
   let currentPoint = { x: 3, y: 4, r: 5, theta: 0.927 };

   function drawCoordinateSystem() {
     const canvas = document.getElementById('coordinate-canvas');
     const ctx = canvas.getContext('2d');
     const width = canvas.width;
     const height = canvas.height;
     const centerX = width / 2;
     const centerY = height / 2;
     const scale = 30; // pixels per unit

     ctx.clearRect(0, 0, width, height);

     // Draw grid
     ctx.strokeStyle = '#f0f0f0';
     ctx.lineWidth = 1;
     for (let i = -10; i <= 10; i++) {
       // Vertical lines
       ctx.beginPath();
       ctx.moveTo(centerX + i * scale, 0);
       ctx.lineTo(centerX + i * scale, height);
       ctx.stroke();

       // Horizontal lines
       ctx.beginPath();
       ctx.moveTo(0, centerY + i * scale);
       ctx.lineTo(width, centerY + i * scale);
       ctx.stroke();
     }

     // Draw axes
     ctx.strokeStyle = '#333';
     ctx.lineWidth = 2;
     ctx.beginPath();
     ctx.moveTo(0, centerY);
     ctx.lineTo(width, centerY);
     ctx.moveTo(centerX, 0);
     ctx.lineTo(centerX, height);
     ctx.stroke();

     // Draw point
     const pixelX = centerX + currentPoint.x * scale;
     const pixelY = centerY - currentPoint.y * scale; // Flip Y for canvas coordinates

     // Draw polar representation
     ctx.strokeStyle = '#e74c3c';
     ctx.lineWidth = 2;
     ctx.beginPath();
     ctx.moveTo(centerX, centerY);
     ctx.lineTo(pixelX, pixelY);
     ctx.stroke();

     // Draw angle arc
     if (currentPoint.r > 0) {
       ctx.beginPath();
       ctx.arc(centerX, centerY, 40, 0, currentPoint.theta, currentPoint.theta > 0);
       ctx.strokeStyle = '#e74c3c';
       ctx.setLineDash([5, 5]);
       ctx.stroke();
       ctx.setLineDash([]);
     }

     // Draw Cartesian projections
     ctx.strokeStyle = '#27ae60';
     ctx.setLineDash([3, 3]);
     ctx.beginPath();
     ctx.moveTo(pixelX, pixelY);
     ctx.lineTo(pixelX, centerY);
     ctx.lineTo(centerX, centerY);
     ctx.stroke();
     ctx.setLineDash([]);

     // Draw point
     ctx.fillStyle = '#3498db';
     ctx.beginPath();
     ctx.arc(pixelX, pixelY, 6, 0, 2 * Math.PI);
     ctx.fill();

     // Labels
     ctx.fillStyle = '#333';
     ctx.font = '14px Arial';
     ctx.fillText(`(${currentPoint.x}, ${currentPoint.y})`, pixelX + 10, pixelY - 10);
     ctx.fillText(`(${currentPoint.r.toFixed(2)}, ${(currentPoint.theta * 180 / Math.PI).toFixed(1)}°)`, pixelX + 10, pixelY + 25);

     // Axis labels
     ctx.fillText('x', width - 20, centerY - 10);
     ctx.fillText('y', centerX + 10, 20);
     ctx.fillText('0', centerX - 15, centerY + 20);
   }

   function convertCartesianToPolar() {
     const x = parseFloat(document.getElementById('cart-x').value);
     const y = parseFloat(document.getElementById('cart-y').value);

     const r = Math.sqrt(x * x + y * y);
     let theta = Math.atan2(y, x); // atan2 handles all quadrants correctly

     currentPoint = { x, y, r, theta };
     updateDisplay();
     drawCoordinateSystem();
   }

   function convertPolarToCartesian() {
     const r = parseFloat(document.getElementById('polar-r').value);
     const theta = parseFloat(document.getElementById('polar-theta').value);

     const x = r * Math.cos(theta);
     const y = r * Math.sin(theta);

     currentPoint = { x, y, r, theta };
     updateDisplay();
     drawCoordinateSystem();
   }

   function updateDisplay() {
     const resultDiv = document.getElementById('conversion-result');
     const thetaDeg = (currentPoint.theta * 180 / Math.PI).toFixed(2);

     resultDiv.innerHTML = `Cartesian: (${currentPoint.x.toFixed(2)}, ${currentPoint.y.toFixed(2)}) → ` +
                          `Polar: (${currentPoint.r.toFixed(2)}, ${currentPoint.theta.toFixed(3)} rad) or ` +
                          `(${currentPoint.r.toFixed(2)}, ${thetaDeg}°)<br>` +
                          `Polar: (${currentPoint.r.toFixed(2)}, ${currentPoint.theta.toFixed(3)}) → ` +
                          `Cartesian: (${currentPoint.x.toFixed(2)}, ${currentPoint.y.toFixed(2)})`;
   }

   // Solution toggle function
   function toggleSolution(id) {
     const element = document.getElementById(id);
     const button = element.previousElementSibling;
     if (element.style.display === 'none' || element.style.display === '') {
       element.style.display = 'block';
       button.textContent = 'Hide Solution';
     } else {
       element.style.display = 'none';
       button.textContent = 'Show Solution';
     }
   }

   // Initialize
   document.addEventListener('DOMContentLoaded', function() {
     drawCoordinateSystem();
     updateDisplay();

     // MathJax rendering
     if (typeof renderMathInElement !== 'undefined') {
       renderMathInElement(document.body, {
         delimiters: [
           {left: "$$", right: "$$", display: true},
           {left: "\\(", right: "\\)", display: false},
           {left: "\\[", right: "\\]", display: true}
         ],
         throwOnError: false
       });
     }
   });
  </script>
 </body>
</html>
