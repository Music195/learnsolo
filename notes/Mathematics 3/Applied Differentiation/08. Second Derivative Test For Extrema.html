<!DOCTYPE html>
<!-- tags: Mathematics -->
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Second Derivative Test for Extrema
  </title>
  <script>
   MathJax = {
            tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
            svg: {fontCache: 'global'}
        };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <link href="/static/notes_style.css" rel="stylesheet"/>
  <style>
   .interactive-demo {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
    border: 2px solid #e1e8ed;
   }
   .demo-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-bottom: 15px;
   }
   .demo-input-group {
    display: flex;
    flex-direction: column;
    min-width: 200px;
   }
   .demo-input-group label {
    font-weight: bold;
    margin-bottom: 5px;
    color: #2c3e50;
   }
   .demo-input {
    padding: 8px;
    border: 2px solid #bdc3c7;
    border-radius: 6px;
    font-size: 14px;
    transition: border-color 0.3s;
   }
   .demo-input:focus {
    outline: none;
    border-color: #3498db;
   }
   .demo-button {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: transform 0.2s;
   }
   .demo-button:hover {
    transform: translateY(-2px);
   }
   .demo-result {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin-top: 15px;
    border-left: 4px solid #3498db;
   }
   .math-foundation {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    border-radius: 12px;
    margin: 20px 0;
   }
   .worked-example {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    padding: 20px;
    border-radius: 12px;
    margin: 20px 0;
   }
   .practice-problem {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    color: white;
    padding: 20px;
    border-radius: 12px;
    margin: 20px 0;
   }
   .solution-toggle {
    background: #2c3e50;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    margin-top: 10px;
    transition: background-color 0.3s;
   }
   .solution-toggle:hover {
    background: #34495e;
   }
   .solution-content {
    display: none;
    background: rgba(255, 255, 255, 0.9);
    color: #2c3e50;
    padding: 15px;
    border-radius: 8px;
    margin-top: 10px;
   }
   .key-takeaways {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    padding: 20px;
    border-radius: 12px;
    margin: 20px 0;
   }
   .key-takeaways h3 {
    color: #2c3e50;
    margin-top: 0;
   }
   .key-takeaways ul {
    color: #2c3e50;
   }
   .test-concepts {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 15px;
    margin: 20px 0;
   }
   .concept-card {
    background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
    padding: 15px;
    border-radius: 8px;
    border-left: 4px solid #e67e22;
   }
   .concept-card h4 {
    margin-top: 0;
    color: #2c3e50;
   }
   .math-orange {
    color: #e67e22;
    font-weight: bold;
   }
   .visualization-section {
    background: white;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
    border: 2px solid #ecf0f1;
    text-align: center;
   }
   canvas {
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin: 10px 0;
   }
   .theorem-box {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    border-radius: 12px;
    margin: 20px 0;
    border-left: 5px solid #3498db;
   }
   .comparison-section {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    padding: 20px;
    border-radius: 12px;
    margin: 20px 0;
   }
   .inconclusive-cases {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    color: white;
    padding: 20px;
    border-radius: 12px;
    margin: 20px 0;
   }
  </style>
 </head>
 <body>
  <div class="fancy-title" data-topic="Mathematics">
   Second Derivative Test for Extrema
  </div>
  <div class="container">
   <div class="main-content">
    <div class="section-title">
     Second Derivative Test for Extrema
    </div>

    <div class="theorem-box">
     <h3>The Second Derivative Test</h3>
     <p>Suppose $f'(a) = 0$ (critical point) and $f''(a)$ exists. Then:</p>
     <div style="text-align: center; font-size: 1.2em; margin: 20px 0;">
      <div style="color: #27ae60; font-weight: bold; margin: 10px 0;">$f''(a) > 0$ ⇒ Local Minimum</div>
      <div style="color: #e74c3c; font-weight: bold; margin: 10px 0;">$f''(a) < 0$ ⇒ Local Maximum</div>
      <div style="color: #f39c12; font-weight: bold; margin: 10px 0;">$f''(a) = 0$ ⇒ Inconclusive</div>
     </div>
    </div>

    <div class="math-foundation">
     <h3>Mathematical Foundations</h3>
     <p>The Second Derivative Test connects concavity with the nature of critical points. When the second derivative is positive, the function curves upward like a bowl, so a critical point must be at the bottom (minimum). When negative, it curves downward like a hill, so the critical point is at the top (maximum).</p>

     <div class="test-concepts">
      <div class="concept-card">
       <h4>Critical Points</h4>
       <p>Points where f'(x) = 0</p>
       <p>Or where f' is undefined</p>
       <p>Potential extrema locations</p>
       <p>Horizontal tangent lines</p>
      </div>

      <div class="concept-card">
       <h4>Concavity Connection</h4>
       <p>f'' > 0: Concave up (∪)</p>
       <p>f'' < 0: Concave down (∩)</p>
       <p>Critical point behavior</p>
       <p>Geometric interpretation</p>
      </div>

      <div class="concept-card">
       <h4>Test Limitations</h4>
       <p>f'' must exist at critical point</p>
       <p>Inconclusive when f'' = 0</p>
       <p>Need alternative tests</p>
       <p>Domain restrictions apply</p>
      </div>

      <div class="concept-card">
       <h4>Practical Applications</h4>
       <p>Optimization problems</p>
       <p>Economic analysis</p>
       <p>Physics equilibrium</p>
       <p>Engineering design</p>
      </div>
     </div>
    </div>

    <div class="interactive-demo">
     <h3>Interactive Second Derivative Test Calculator</h3>
     <p>Enter a function and a critical point to apply the Second Derivative Test.</p>

     <div class="demo-controls">
      <div class="demo-input-group">
       <label for="function-input">Function f(x):</label>
       <input type="text" id="function-input" class="demo-input" value="x^3 - 3x^2 - 9x + 5" placeholder="e.g., x^3 - 3x^2 - 9x + 5">
      </div>
      <div class="demo-input-group">
       <label for="critical-point">Critical Point x =</label>
       <input type="number" id="critical-point" class="demo-input" value="-1" step="0.1">
      </div>
      <button onclick="applySecondDerivativeTest()" class="demo-button">Apply Test</button>
     </div>

     <div class="demo-result">
      <h4>Test Results:</h4>
      <p><strong>Function:</strong> <span id="function-display">f(x) = x³ - 3x² - 9x + 5</span></p>
      <p><strong>Critical Point:</strong> <span id="critical-display">x = -1</span></p>
      <p><strong>First Derivative:</strong> <span id="first-deriv-display">f'(x) = 3x² - 6x - 9</span></p>
      <p><strong>Verification:</strong> <span id="verification-display">f'(-1) = 0 ✓</span></p>
      <p><strong>Second Derivative:</strong> <span id="second-deriv-display">f''(x) = 6x - 6</span></p>
      <p><strong>Test Value:</strong> <span id="test-value-display">f''(-1) = -12</span></p>
      <p><strong>Conclusion:</strong> <span id="conclusion-display">Local Maximum</span></p>
     </div>

     <div class="visualization-section">
      <h4>Function Behavior at Critical Point:</h4>
      <canvas id="testVisualizationCanvas" width="600" height="400"></canvas>
      <p><em>The red dot shows the critical point. The curve shape indicates the type of extremum.</em></p>
     </div>
    </div>

    <div class="comparison-section">
     <h3>Comparison: First vs Second Derivative Tests</h3>

     <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
      <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
       <h4 style="margin-top: 0;">First Derivative Test</h4>
       <ul style="line-height: 1.8;">
        <li>Check sign of f'(x) on both sides of critical point</li>
        <li>f' changes from + to -: local maximum</li>
        <li>f' changes from - to +: local minimum</li>
        <li><strong>Advantage:</strong> Always works when f' exists</li>
        <li><strong>Disadvantage:</strong> Requires testing intervals</li>
       </ul>
      </div>

      <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
       <h4 style="margin-top: 0;">Second Derivative Test</h4>
       <ul style="line-height: 1.8;">
        <li>Check sign of f''(a) at the critical point only</li>
        <li>f''(a) > 0: local minimum</li>
        <li>f''(a) < 0: local maximum</li>
        <li><strong>Advantage:</strong> Faster—one evaluation needed</li>
        <li><strong>Disadvantage:</strong> Inconclusive when f''(a) = 0</li>
       </ul>
      </div>
     </div>
    </div>

    <div class="inconclusive-cases">
     <h3>When the Test Fails: Inconclusive Cases</h3>
     <p>When $f'(a) = 0$ and $f''(a) = 0$, the Second Derivative Test gives no information.</p>

     <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 20px;">
      <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
       <h4 style="margin-top: 0; color: #27ae60;">Local Minimum</h4>
       <p>f(x) = x⁴ at x = 0</p>
       <p>f'(0) = 0, f''(0) = 0</p>
       <p>But it IS a local minimum!</p>
      </div>

      <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
       <h4 style="margin-top: 0; color: #e74c3c;">Local Maximum</h4>
       <p>f(x) = -x⁴ at x = 0</p>
       <p>f'(0) = 0, f''(0) = 0</p>
       <p>But it IS a local maximum!</p>
      </div>

      <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center;">
       <h4 style="margin-top: 0; color: #f39c12;">Neither (Inflection)</h4>
       <p>f(x) = x³ at x = 0</p>
       <p>f'(0) = 0, f''(0) = 0</p>
       <p>But it's NOT an extremum!</p>
      </div>
     </div>

     <p style="margin-top: 20px;"><strong>Solution:</strong> Use the First Derivative Test or check higher derivatives when inconclusive.</p>
    </div>

    <div class="worked-example">
     <h3>Worked Examples</h3>

     <div style="margin-bottom: 20px;">
      <h4>Example 1: Cubic Function with Two Critical Points</h4>
      <p>Classify critical points of $f(x) = x^3 - 3x^2 - 9x + 5$.</p>
      <p><strong>Step 1:</strong> Find critical points: f'(x) = 3x² - 6x - 9 = 3(x - 3)(x + 1) = 0</p>
      <p><strong>Step 2:</strong> Critical points: x = -1, x = 3</p>
      <p><strong>Step 3:</strong> Second derivative: f''(x) = 6x - 6</p>
      <p><strong>Step 4:</strong> At x = -1: f''(-1) = 6(-1) - 6 = -12 < 0 → Local maximum</p>
      <p><strong>Step 5:</strong> At x = 3: f''(3) = 6(3) - 6 = 12 > 0 → Local minimum</p>
     </div>

     <div style="margin-bottom: 20px;">
      <h4>Example 2: Quartic Function</h4>
      <p>Classify the critical point of $f(x) = x^4 - 4x^3$ at x = 3.</p>
      <p><strong>Step 1:</strong> Verify critical point: f'(x) = 4x³ - 12x² = 4x²(x - 3), f'(3) = 0 ✓</p>
      <p><strong>Step 2:</strong> Second derivative: f''(x) = 12x² - 24x = 12x(x - 2)</p>
      <p><strong>Step 3:</strong> f''(3) = 12(3)(3 - 2) = 36 > 0 → Local minimum</p>
     </div>

     <div style="margin-bottom: 20px;">
      <h4>Example 3: Test Fails - Use First Derivative Test</h4>
      <p>Classify the critical point of $f(x) = x^3$ at x = 0.</p>
      <p><strong>Step 1:</strong> f'(x) = 3x², f'(0) = 0 ✓</p>
      <p><strong>Step 2:</strong> f''(x) = 6x, f''(0) = 0 → Inconclusive!</p>
      <p><strong>Step 3:</strong> Use First Derivative Test:</p>
      <p><strong>Step 4:</strong> x < 0: f'(x) = 3x² > 0 (increasing)</p>
      <p><strong>Step 5:</strong> x > 0: f'(x) = 3x² > 0 (increasing)</p>
      <p><strong>Step 6:</strong> No sign change → NOT an extremum (inflection point)</p>
     </div>

     <div style="margin-bottom: 20px;">
      <h4>Example 4: Rational Function</h4>
      <p>Classify critical points of $f(x) = x + \frac{1}{x}$ for x ≠ 0.</p>
      <p><strong>Step 1:</strong> f'(x) = 1 - 1/x² = (x² - 1)/x² = ((x - 1)(x + 1))/x²</p>
      <p><strong>Step 2:</strong> Critical points: x = 1, x = -1</p>
      <p><strong>Step 3:</strong> f''(x) = 2/x³</p>
      <p><strong>Step 4:</strong> At x = 1: f''(1) = 2/1³ = 2 > 0 → Local minimum</p>
      <p><strong>Step 5:</strong> At x = -1: f''(-1) = 2/(-1)³ = -2 < 0 → Local maximum</p>
     </div>
    </div>

    <div class="practice-problem">
     <h3>Practice Problems</h3>

     <div style="margin-bottom: 20px;">
      <h4>Problem 1</h4>
      <p>Use the Second Derivative Test to classify critical points of $f(x) = x^3 + x^2 - 2x + 1$.</p>
      <button onclick="toggleSolution('sol1')" class="solution-toggle">Show Solution</button>
      <div id="sol1" class="solution-content">
       <p><strong>Step 1:</strong> f'(x) = 3x² + 2x - 2</p>
       <p><strong>Step 2:</strong> Critical points: 3x² + 2x - 2 = 0 ⇒ x = (-2±√(4+24))/6 = (-2±√28)/6 = (-2±2√7)/6 = (-1±√7)/3</p>
       <p><strong>Step 3:</strong> f''(x) = 6x + 2</p>
       <p><strong>Step 4:</strong> At x = (-1+√7)/3 ≈ 0.549: f'' > 0 → Local minimum</p>
       <p><strong>Step 5:</strong> At x = (-1-√7)/3 ≈ -1.549: f'' < 0 → Local maximum</p>
      </div>
     </div>

     <div style="margin-bottom: 20px;">
      <h4>Problem 2</h4>
      <p>Classify the critical point of $f(x) = e^{-x^2}$ at x = 0.</p>
      <button onclick="toggleSolution('sol2')" class="solution-toggle">Show Solution</button>
      <div id="sol2" class="solution-content">
       <p><strong>Step 1:</strong> f'(x) = -2xe^{-x^2}, f'(0) = 0 ✓</p>
       <p><strong>Step 2:</strong> f''(x) = -2e^{-x^2} + 4x²e^{-x^2} = 2e^{-x^2}(2x² - 1)</p>
       <p><strong>Step 3:</strong> f''(0) = 2(0 - 1) = -2 < 0 → Local maximum</p>
      </div>
     </div>

     <div style="margin-bottom: 20px;">
      <h4>Problem 3</h4>
      <p>Determine if $f(x) = x^4$ has any extrema using the Second Derivative Test.</p>
      <button onclick="toggleSolution('sol3')" class="solution-toggle">Show Solution</button>
      <div id="sol3" class="solution-content">
       <p><strong>Step 1:</strong> f'(x) = 4x³, f'(0) = 0 ✓</p>
       <p><strong>Step 2:</strong> f''(x) = 12x², f''(0) = 0 → Inconclusive</p>
       <p><strong>Step 3:</strong> Use First Derivative Test: f'(x) = 4x³</p>
       <p><strong>Step 4:</strong> x < 0: f'(x) < 0 (decreasing)</p>
       <p><strong>Step 5:</strong> x > 0: f'(x) > 0 (increasing)</p>
       <p><strong>Step 6:</strong> Sign change from - to + → Local minimum at x = 0</p>
      </div>
     </div>

     <div style="margin-bottom: 20px;">
      <h4>Problem 4</h4>
      <p>Find and classify extrema of $f(x) = \ln(x)$ for x > 0.</p>
      <button onclick="toggleSolution('sol4')" class="solution-toggle">Show Solution</button>
      <div id="sol4" class="solution-content">
       <p><strong>Step 1:</strong> f'(x) = 1/x, never zero in domain x > 0</p>
       <p><strong>Step 2:</strong> No critical points → No extrema</p>
       <p><strong>Note:</strong> f''(x) = -1/x² < 0, so always concave down</p>
      </div>
     </div>
    </div>

    <div class="key-takeaways">
     <h3>Key Takeaways</h3>
     <ul>
      <li><strong>Test Rule:</strong> f''(a) > 0 → local min, f''(a) < 0 → local max, f''(a) = 0 → inconclusive</li>
      <li><strong>Prerequisite:</strong> Must have f'(a) = 0 (critical point) and f''(a) exists</li>
      <li><strong>Geometric:</strong> Positive second derivative means concave up (bowl shape) → minimum at bottom</li>
      <li><strong>Advantage:</strong> Faster than First Derivative Test when applicable</li>
      <li><strong>Limitation:</strong> Inconclusive when f''(a) = 0; use First Derivative Test instead</li>
      <li><strong>Applications:</strong> Optimization, economics, physics, engineering</li>
      <li><strong>Memory:</strong> Positive = minimum (bottom of bowl), negative = maximum (top of hill)</li>
     </ul>
    </div>

    <div class="formula-list">
     <div class="formula-row">
      <span class="number">
       1
      </span>
      <span class="formula">
       $f''(a) > 0$
       <span class="math-orange">
        (Local Minimum)
       </span>
      </span>
     </div>
     <div class="formula-row">
      <span class="number">
       2
      </span>
      <span class="formula">
       $f''(a) < 0$
       <span class="math-orange">
        (Local Maximum)
       </span>
      </span>
     </div>
     <div class="formula-row">
      <span class="number">
       3
      </span>
      <span class="formula">
       $f''(a) = 0$
       <span class="math-orange">
        (Inconclusive)
       </span>
      </span>
     </div>
    </div>

    <div class="visualization-section">
     <h4>Second Derivative Test Visualization</h4>
     <p>Interactive demonstration of the Second Derivative Test:</p>
     <canvas id="comprehensiveVisualizationCanvas" width="600" height="400"></canvas>
     <p><em>Move the slider to see how concavity determines the type of extremum</em></p>
     <input type="range" id="concavitySlider" min="-2" max="2" step="0.1" value="1" style="width: 100%; margin-top: 10px;">
    </div>
   </div>
  </div>

  <script>
   function evaluateFunction(func, x) {
    const expr = func.toLowerCase().replace(/\s/g, '');
    if (expr === 'x^3-3x^2-9x+5') return x*x*x - 3*x*x - 9*x + 5;
    if (expr === 'x^4-4x^3') return x*x*x*x - 4*x*x*x;
    if (expr === 'x^3') return x*x*x;
    if (expr === 'x+1/x') return x + 1/x;
    if (expr === 'x^3+x^2-2x+1') return x*x*x + x*x - 2*x + 1;
    if (expr === 'e^{-x^2}') return Math.exp(-x*x);
    if (expr === 'ln(x)') return Math.log(x);
    if (expr === 'x^4') return x*x*x*x;
    return x*x*x - 3*x*x - 9*x + 5; // default
   }

   function evaluateFirstDerivative(func, x) {
    const expr = func.toLowerCase().replace(/\s/g, '');
    if (expr === 'x^3-3x^2-9x+5') return 3*x*x - 6*x - 9;
    if (expr === 'x^4-4x^3') return 4*x*x*x - 12*x*x;
    if (expr === 'x^3') return 3*x*x;
    if (expr === 'x+1/x') return 1 - 1/(x*x);
    if (expr === 'x^3+x^2-2x+1') return 3*x*x + 2*x - 2;
    if (expr === 'e^{-x^2}') return -2*x*Math.exp(-x*x);
    if (expr === 'ln(x)') return 1/x;
    if (expr === 'x^4') return 4*x*x*x;
    return 3*x*x - 6*x - 9; // default
   }

   function evaluateSecondDerivative(func, x) {
    const expr = func.toLowerCase().replace(/\s/g, '');
    if (expr === 'x^3-3x^2-9x+5') return 6*x - 6;
    if (expr === 'x^4-4x^3') return 12*x*x - 24*x;
    if (expr === 'x^3') return 6*x;
    if (expr === 'x+1/x') return 2/(x*x*x);
    if (expr === 'x^3+x^2-2x+1') return 6*x + 2;
    if (expr === 'e^{-x^2}') return 2*Math.exp(-x*x)*(2*x*x - 1);
    if (expr === 'ln(x)') return -1/(x*x);
    if (expr === 'x^4') return 12*x*x;
    return 6*x - 6; // default
   }

   function getFirstDerivativeString(func) {
    const expr = func.toLowerCase().replace(/\s/g, '');
    if (expr === 'x^3-3x^2-9x+5') return '3x² - 6x - 9';
    if (expr === 'x^4-4x^3') return '4x³ - 12x²';
    if (expr === 'x^3') return '3x²';
    if (expr === 'x+1/x') return '1 - 1/x²';
    if (expr === 'x^3+x^2-2x+1') return '3x² + 2x - 2';
    if (expr === 'e^{-x^2}') return '-2xe^{-x^2}';
    if (expr === 'ln(x)') return '1/x';
    if (expr === 'x^4') return '4x³';
    return '3x² - 6x - 9'; // default
   }

   function getSecondDerivativeString(func) {
    const expr = func.toLowerCase().replace(/\s/g, '');
    if (expr === 'x^3-3x^2-9x+5') return '6x - 6';
    if (expr === 'x^4-4x^3') return '12x² - 24x';
    if (expr === 'x^3') return '6x';
    if (expr === 'x+1/x') return '2/x³';
    if (expr === 'x^3+x^2-2x+1') return '6x + 2';
    if (expr === 'e^{-x^2}') return '2e^{-x^2}(2x² - 1)';
    if (expr === 'ln(x)') return '-1/x²';
    if (expr === 'x^4') return '12x²';
    return '6x - 6'; // default
   }

   function applySecondDerivativeTest() {
    const funcInput = document.getElementById('function-input').value;
    const criticalPoint = parseFloat(document.getElementById('critical-point').value);

    if (!funcInput || isNaN(criticalPoint)) {
     alert('Please enter valid function and critical point');
     return;
    }

    const firstDerivValue = evaluateFirstDerivative(funcInput, criticalPoint);
    const secondDerivValue = evaluateSecondDerivative(funcInput, criticalPoint);

    document.getElementById('function-display').textContent = `f(x) = ${funcInput}`;
    document.getElementById('critical-display').textContent = `x = ${criticalPoint}`;
    document.getElementById('first-deriv-display').textContent = `f'(x) = ${getFirstDerivativeString(funcInput)}`;
    document.getElementById('verification-display').textContent = `f'(${criticalPoint}) = ${firstDerivValue.toFixed(3)} ${Math.abs(firstDerivValue) < 0.001 ? '✓' : '✗'}`;
    document.getElementById('second-deriv-display').textContent = `f''(x) = ${getSecondDerivativeString(funcInput)}`;
    document.getElementById('test-value-display').textContent = `f''(${criticalPoint}) = ${secondDerivValue.toFixed(3)}`;

    let conclusion = 'Inconclusive - use First Derivative Test';
    if (secondDerivValue > 0.001) conclusion = 'Local Minimum';
    else if (secondDerivValue < -0.001) conclusion = 'Local Maximum';

    document.getElementById('conclusion-display').textContent = conclusion;

    drawTestVisualization(funcInput, criticalPoint, secondDerivValue);
   }

   function drawTestVisualization(func, criticalPoint, secondDerivValue) {
    const canvas = document.getElementById('testVisualizationCanvas');
    const ctx = canvas.getContext('2d');

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const width = canvas.width;
    const height = canvas.height;
    const scale = 30;
    const originX = width / 2;
    const originY = height / 2;

    function toCanvasX(x) { return originX + x * scale; }
    function toCanvasY(y) { return originY - y * scale; }

    // Draw function curve
    ctx.strokeStyle = '#2196F3';
    ctx.lineWidth = 2;
    ctx.beginPath();
    for (let x = -10; x <= 10; x += 0.1) {
     const y = evaluateFunction(func, x);
     if (x === -10) ctx.moveTo(toCanvasX(x), toCanvasY(y));
     else ctx.lineTo(toCanvasX(x), toCanvasY(y));
    }
    ctx.stroke();

    // Draw critical point
    const y = evaluateFunction(func, criticalPoint);
    ctx.fillStyle = secondDerivValue > 0 ? '#27ae60' : secondDerivValue < 0 ? '#e74c3c' : '#f39c12';
    ctx.beginPath();
    ctx.arc(toCanvasX(criticalPoint), toCanvasY(y), 8, 0, 2 * Math.PI);
    ctx.fill();

    // Draw horizontal tangent
    ctx.strokeStyle = '#FF6600';
    ctx.lineWidth = 2;
    ctx.setLineDash([5, 5]);
    ctx.beginPath();
    ctx.moveTo(toCanvasX(criticalPoint - 2), toCanvasY(y));
    ctx.lineTo(toCanvasX(criticalPoint + 2), toCanvasY(y));
    ctx.stroke();
    ctx.setLineDash([]);
   }

   function toggleSolution(id) {
    const element = document.getElementById(id);
    element.style.display = element.style.display === 'none' ? 'block' : 'none';
   }

   // Initialize
   applySecondDerivativeTest();

   // Comprehensive visualization
   const slider = document.getElementById('concavitySlider');
   const compCanvas = document.getElementById('comprehensiveVisualizationCanvas');

   function drawComprehensiveVisualization() {
    const ctx = compCanvas.getContext('2d');
    ctx.clearRect(0, 0, compCanvas.width, compCanvas.height);

    const width = compCanvas.width;
    const height = compCanvas.height;
    const scale = 40;
    const originX = width / 2;
    const originY = height / 2;

    function toCanvasX(x) { return originX + x * scale; }
    function toCanvasY(y) { return originY - y * scale; }

    const a = parseFloat(slider.value);

    // Draw function: f(x) = (a/2)x² + x³ (to create different concavity)
    ctx.strokeStyle = '#2196F3';
    ctx.lineWidth = 2;
    ctx.beginPath();
    for (let x = -5; x <= 5; x += 0.1) {
     const y = (a/2)*x*x + 0.1*x*x*x; // Mix of quadratic and cubic
     if (x === -5) ctx.moveTo(toCanvasX(x), toCanvasY(y));
     else ctx.lineTo(toCanvasX(x), toCanvasY(y));
    }
    ctx.stroke();

    // Mark critical point at x = 0
    const y = 0;
    ctx.fillStyle = a > 0 ? '#27ae60' : a < 0 ? '#e74c3c' : '#f39c12';
    ctx.beginPath();
    ctx.arc(toCanvasX(0), toCanvasY(y), 8, 0, 2 * Math.PI);
    ctx.fill();

    // Label
    ctx.font = '16px Arial';
    ctx.fillStyle = '#000';
    ctx.textAlign = 'center';
    ctx.fillText(`f''(0) = ${a}`, toCanvasX(0), toCanvasY(y) - 20);
    ctx.fillText(a > 0 ? 'Local Min' : a < 0 ? 'Local Max' : 'Inconclusive', toCanvasX(0), toCanvasY(y) + 30);
   }

   slider.addEventListener('input', drawComprehensiveVisualization);
   drawComprehensiveVisualization();
  </script>
 </body>
</html>