<!DOCTYPE html>
<!-- tags: Geometry -->
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Position Relationship Between a Circle and a Line
  </title>
  <script>
   MathJax = {
            tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]},
            svg: {fontCache: 'global'}
        };
  </script>
  <script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>
  <link href="/static/notes_style.css" rel="stylesheet"/>
  <style>
   .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
   }

   .main-content {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border-radius: 15px;
    padding: 30px;
    margin: 20px 0;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
   }

   .fancy-title {
    text-align: center;
    font-size: 2.5em;
    font-weight: bold;
    margin: 20px 0;
    color: #2c3e50;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
   }

   .description {
    font-size: 1.2em;
    line-height: 1.6;
    margin: 20px 0;
    color: #34495e;
    text-align: center;
   }

   .content-wrapper {
    display: flex;
    flex-wrap: wrap;
    gap: 30px;
    margin: 30px 0;
   }

   .formula-block {
    flex: 1;
    min-width: 300px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 25px;
    border-radius: 12px;
    text-align: center;
    font-size: 1.4em;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
   }

   .formula-item {
    margin: 15px 0;
    padding: 10px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
   }

   .graybox {
    background: linear-gradient(135deg, #bdc3c7 0%, #95a5a6 100%);
    color: #2c3e50;
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    text-align: center;
    font-weight: bold;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
   }

   .interactive-demo {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    border-radius: 15px;
    margin: 30px 0;
    box-shadow: 0 8px 32px rgba(0,0,0,0.15);
   }

   .demo-title {
    text-align: center;
    font-size: 1.8em;
    margin-bottom: 25px;
    font-weight: bold;
   }

   .input-group {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin: 20px 0;
    justify-content: center;
   }

   .input-field {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
   }

   .input-field label {
    font-weight: bold;
    font-size: 1.1em;
   }

   .input-field input {
    padding: 10px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1em;
    width: 120px;
    text-align: center;
    transition: border-color 0.3s;
   }

   .input-field input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
   }

   .select-field {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
   }

   .select-field label {
    font-weight: bold;
    font-size: 1.1em;
   }

   .select-field select {
    padding: 10px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 1em;
    width: 140px;
    text-align: center;
    transition: border-color 0.3s;
   }

   .select-field select:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
   }

   .button-group {
    text-align: center;
    margin: 25px 0;
   }

   .btn {
    background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
    color: white;
    border: none;
    padding: 12px 25px;
    border-radius: 8px;
    font-size: 1.1em;
    cursor: pointer;
    margin: 0 10px;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
   }

   .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
   }

   .btn:active {
    transform: translateY(0);
   }

   .result-display {
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    backdrop-filter: blur(10px);
   }

   .result-text {
    font-size: 1.2em;
    text-align: center;
    margin: 10px 0;
   }

   .section {
    background: white;
    padding: 25px;
    border-radius: 12px;
    margin: 25px 0;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
   }

   .section-title {
    font-size: 1.8em;
    font-weight: bold;
    color: #2c3e50;
    margin-bottom: 20px;
    text-align: center;
   }

   .canvas-container {
    text-align: center;
    margin: 20px 0;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
   }

   .canvas-title {
    font-size: 1.2em;
    font-weight: bold;
    margin-bottom: 15px;
    color: #2c3e50;
   }

   .formula-display {
    text-align: center;
    margin: 15px 0;
    font-size: 1.3em;
    font-weight: bold;
    color: #e74c3c;
   }

   .cases-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 20px;
    margin: 20px 0;
   }

   .case-card {
    background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    box-shadow: 0 4px 15px rgba(252, 182, 159, 0.3);
   }

   .case-card h3 {
    margin: 0 0 15px 0;
    color: #333;
    font-size: 1.3em;
   }

   .case-card .formula {
    font-weight: bold;
    color: #e74c3c;
    font-size: 1.2em;
    margin: 10px 0;
   }

   .case-card .description {
    color: #555;
    line-height: 1.5;
   }

   .example-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin: 20px 0;
   }

   .example-card {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    padding: 20px;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3);
   }

   .example-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(245, 87, 108, 0.4);
   }

   .example-card h4 {
    margin: 0 0 10px 0;
    font-size: 1.2em;
   }

   .example-detail {
    background: rgba(255, 255, 255, 0.95);
    color: #333;
    padding: 20px;
    border-radius: 10px;
    margin: 15px 0;
    display: none;
   }

   .calculation-steps {
    margin: 15px 0;
   }

   .calculation-step {
    margin: 8px 0;
    padding: 8px;
    background: rgba(255, 255, 255, 0.8);
    border-radius: 5px;
    border-left: 4px solid #f5576c;
   }

   .practice-problems {
    margin: 20px 0;
   }

   .problem-item {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px;
    border-radius: 10px;
    margin: 15px 0;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
   }

   .problem-item h4 {
    margin: 0 0 15px 0;
    font-size: 1.2em;
   }

   .solution-btn {
    background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
    color: #333;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    margin: 10px 0;
    transition: all 0.3s;
   }

   .solution-btn:hover {
    background: linear-gradient(135deg, #fcb69f 0%, #ffecd2 100%);
    transform: scale(1.05);
   }

   .solution {
    background: rgba(255, 255, 255, 0.9);
    color: #333;
    padding: 15px;
    border-radius: 8px;
    margin: 10px 0;
    display: none;
    border-left: 4px solid #667eea;
   }

   .key-takeaways {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    padding: 25px;
    border-radius: 12px;
    margin: 25px 0;
   }

   .takeaway-list {
    list-style: none;
    padding: 0;
   }

   .takeaway-item {
    background: rgba(255, 255, 255, 0.8);
    margin: 10px 0;
    padding: 15px;
    border-radius: 8px;
    border-left: 4px solid #667eea;
    font-weight: bold;
   }

   .error-message {
    background: #ffebee;
    color: #c62828;
    padding: 10px;
    border-radius: 5px;
    margin: 10px 0;
    display: none;
    text-align: center;
    font-weight: bold;
   }

   @media (max-width: 768px) {
    .content-wrapper {
     flex-direction: column;
    }

    .input-group {
     flex-direction: column;
     align-items: center;
    }

    .fancy-title {
     font-size: 2em;
    }

    .formula-block {
     font-size: 1.2em;
    }
   }
  </style>
 </head>
 <body>
  <div class="fancy-title" data-topic="Geometry">
   Position Relationship Between a Circle and a Line
  </div>

  <div class="container">
   <div class="main-content">
    <div class="description">
     The position relationship between a circle and a line depends on the perpendicular distance from the circle's center to the line compared to the circle's radius. This fundamental concept determines whether the line intersects, touches, or misses the circle entirely.
    </div>

    <div class="content-wrapper">
     <div class="formula-block">
      <div class="formula-item">
       <strong>Distance Formula:</strong><br/>
       $d = \frac{|ax_0 + by_0 + c|}{\sqrt{a^2 + b^2}}$<br/>
       <strong>Perpendicular distance from center to line</strong>
      </div>
      <div class="formula-item">
       <strong>Relationship:</strong><br/>
       $d < r$: Two intersection points<br/>
       $d = r$: One tangent point<br/>
       $d > r$: No intersection
      </div>
      <div class="formula-item">
       <strong>Circle Equation:</strong><br/>
       $(x - h)^2 + (y - k)^2 = r^2$<br/>
       <strong>Center (h,k), radius r</strong>
      </div>
     </div>

     <div class="graybox">
      The key insight is comparing the perpendicular distance d from the circle's center to the line with the circle's radius r. This comparison determines the geometric relationship between the circle and line.
     </div>
    </div>

    <div class="section">
     <div class="section-title">Three Cases of Circle-Line Relationships</div>
     <div class="cases-grid">
      <div class="case-card">
       <h3>Two Intersection Points</h3>
       <div class="canvas-container">
        <div class="canvas-title">Line intersects circle at two points</div>
        <canvas id="twoPointsCanvas" width="350" height="300"></canvas>
       </div>
       <div class="formula">$$d < r$$</div>
       <div class="description">
        <strong>Condition:</strong> Distance less than radius<br/>
        <strong>Intersection:</strong> Two distinct points<br/>
        <strong>Geometric meaning:</strong> Line crosses through circle<br/>
        <strong>Chord length:</strong> Can be calculated using distance formula
       </div>
      </div>

      <div class="case-card">
       <h3>Tangent (One Point)</h3>
       <div class="canvas-container">
        <div class="canvas-title">Line touches circle at one point</div>
        <canvas id="tangentCanvas" width="350" height="300"></canvas>
       </div>
       <div class="formula">$$d = r$$</div>
       <div class="description">
        <strong>Condition:</strong> Distance equals radius<br/>
        <strong>Intersection:</strong> Exactly one point (tangent point)<br/>
        <strong>Geometric meaning:</strong> Line just touches circle<br/>
        <strong>Tangent line:</strong> Perpendicular to radius at contact point
       </div>
      </div>

      <div class="case-card">
       <h3>No Intersection</h3>
       <div class="canvas-container">
        <div class="canvas-title">Line does not intersect circle</div>
        <canvas id="noPointsCanvas" width="350" height="300"></canvas>
       </div>
       <div class="formula">$$d > r$$</div>
       <div class="description">
        <strong>Condition:</strong> Distance greater than radius<br/>
        <strong>Intersection:</strong> Zero points<br/>
        <strong>Geometric meaning:</strong> Line completely outside circle<br/>
        <strong>Separation:</strong> Minimum distance equals d - r
       </div>
      </div>
     </div>
    </div>

    <div class="interactive-demo">
     <div class="demo-title">Circle-Line Relationship Calculator</div>

     <div class="input-group">
      <div class="input-field">
       <label for="centerX">Center X (h):</label>
       <input id="centerX" placeholder="0" type="number" value="0"/>
      </div>
      <div class="input-field">
       <label for="centerY">Center Y (k):</label>
       <input id="centerY" placeholder="0" type="number" value="0"/>
      </div>
      <div class="input-field">
       <label for="radius">Radius (r):</label>
       <input id="radius" placeholder="3" type="number" value="3" min="0.1" step="0.1"/>
      </div>
     </div>

     <div class="input-group">
      <div class="input-field">
       <label for="lineA">Line A (ax + by + c = 0):</label>
       <input id="lineA" placeholder="1" type="number" value="1"/>
      </div>
      <div class="input-field">
       <label for="lineB">Line B:</label>
       <input id="lineB" placeholder="0" type="number" value="0"/>
      </div>
      <div class="input-field">
       <label for="lineC">Line C:</label>
       <input id="lineC" placeholder="-2" type="number" value="-2"/>
      </div>
     </div>

     <div class="button-group">
      <button class="btn" onclick="calculateRelationship()">Calculate Relationship</button>
      <button class="btn" onclick="resetDemo()">Reset</button>
     </div>

     <div class="error-message" id="errorMessage"></div>

     <div class="result-display">
      <div class="result-text" id="circleDisplay">
       <strong>Circle:</strong> (x - 0)² + (y - 0)² = 3²
      </div>
      <div class="result-text" id="lineDisplay">
       <strong>Line:</strong> x - 2 = 0
      </div>
      <div class="result-text" id="distanceDisplay">
       <strong>Distance d:</strong> 2.00
      </div>
      <div class="result-text" id="relationshipDisplay">
       <strong>Relationship:</strong> d > r (No intersection)
      </div>
     </div>
    </div>

    <div class="section">
     <div class="section-title">Mathematical Foundation</div>
     <p>The position relationship between a circle and a line is determined by comparing the perpendicular distance from the circle's center to the line with the circle's radius:</p>
     <ul>
      <li><strong>Distance formula:</strong> For circle center (h,k) and line ax + by + c = 0, distance d = |ah + bk + c| / √(a² + b²)</li>
      <li><strong>Intersection conditions:</strong> d < r (two points), d = r (tangent), d > r (no intersection)</li>
      <li><strong>Geometric interpretation:</strong> The distance d represents how far the line is from the circle's center</li>
      <li><strong>Special cases:</strong> Vertical lines (b = 0), horizontal lines (a = 0), lines through center (d = 0)</li>
      <li><strong>Chord properties:</strong> When d < r, the intersection points form a chord whose length can be calculated</li>
      <li><strong>Tangent properties:</strong> When d = r, the tangent line is perpendicular to the radius at the point of tangency</li>
      <li><strong>Separation distance:</strong> When d > r, the minimum distance between circle and line is d - r</li>
      <li><strong>Applications:</strong> Used in collision detection, computer graphics, and geometric optimization</li>
     </ul>
     <div class="formula-block" style="margin: 20px 0;">
      \begin{aligned}
      \text{Circle equation:} \\
      (x - h)^2 + (y - k)^2 &= r^2 \\
      \\
      \text{Line equation:} \\
      ax + by + c &= 0 \\
      \\
      \text{Distance formula:} \\
      d &= \frac{|ah + bk + c|}{\sqrt{a^2 + b^2}} \\
      \\
      \text{Relationship conditions:} \\
      d < r &\implies \text{Two intersection points} \\
      d = r &\implies \text{Tangent (one point)} \\
      d > r &\implies \text{No intersection}
      \end{aligned}
     </div>
    </div>

    <div class="section">
     <div class="section-title">Worked Examples</div>
     <div class="example-grid">
      <div class="example-card" onclick="showExample(1)">
       <h4>Example 1: Two Intersection Points</h4>
       <p>Find relationship between circle (x-1)² + (y-2)² = 9 and line x + y - 1 = 0.</p>
      </div>
      <div class="example-card" onclick="showExample(2)">
       <h4>Example 2: Tangent Case</h4>
       <p>Determine if line 3x + 4y - 25 = 0 is tangent to circle x² + y² = 25.</p>
      </div>
      <div class="example-card" onclick="showExample(3)">
       <h4>Example 3: No Intersection</h4>
       <p>Check relationship between circle (x+2)² + (y-1)² = 4 and line y = 5.</p>
      </div>
     </div>

     <div class="example-detail" id="exampleDetail"></div>
    </div>

    <div class="section">
     <div class="section-title">Practice Problems</div>
     <div class="practice-problems">
      <div class="problem-item">
       <h4>Problem 1</h4>
       <p>Determine the relationship between the circle (x-2)² + (y+1)² = 16 and the line x - y + 3 = 0.</p>
       <button class="solution-btn" onclick="toggleSolution(1)">Show Solution</button>
       <div class="solution" id="solution1">
        <p><strong>Solution:</strong></p>
        <p>Circle: center (2,-1), radius r = 4</p>
        <p>Line: x - y + 3 = 0 ⇒ 1x + (-1)y + 3 = 0</p>
        <p>Distance: d = |1(2) + (-1)(-1) + 3| / √(1² + (-1)²) = |2 + 1 + 3| / √2 = 6/√2 = 3√2 ≈ 4.24</p>
        <p>Since d ≈ 4.24 > r = 4, the line does not intersect the circle.</p>
        <p><strong>Result:</strong> No intersection points</p>
       </div>
      </div>

      <div class="problem-item">
       <h4>Problem 2</h4>
       <p>Find the relationship between circle x² + y² = 25 and line 3x + 4y - 25 = 0.</p>
       <button class="solution-btn" onclick="toggleSolution(2)">Show Solution</button>
       <div class="solution" id="solution2">
        <p><strong>Solution:</strong></p>
        <p>Circle: center (0,0), radius r = 5</p>
        <p>Line: 3x + 4y - 25 = 0</p>
        <p>Distance: d = |3(0) + 4(0) - 25| / √(3² + 4²) = 25 / 5 = 5</p>
        <p>Since d = 5 = r = 5, the line is tangent to the circle.</p>
        <p><strong>Result:</strong> Tangent (one intersection point)</p>
       </div>
      </div>

      <div class="problem-item">
       <h4>Problem 3</h4>
       <p>Determine if the line 2x + y - 4 = 0 intersects the circle (x-1)² + (y-1)² = 5.</p>
       <button class="solution-btn" onclick="toggleSolution(3)">Show Solution</button>
       <div class="solution" id="solution3">
        <p><strong>Solution:</strong></p>
        <p>Circle: center (1,1), radius r = √5 ≈ 2.24</p>
        <p>Line: 2x + y - 4 = 0</p>
        <p>Distance: d = |2(1) + 1(1) - 4| / √(2² + 1²) = |2 + 1 - 4| / √5 = 1/√5 ≈ 0.45</p>
        <p>Since d ≈ 0.45 < r ≈ 2.24, the line intersects the circle at two points.</p>
        <p><strong>Result:</strong> Two intersection points</p>
       </div>
      </div>
     </div>
    </div>

    <div class="key-takeaways">
     <div class="section-title">Key Takeaways</div>
     <ul class="takeaway-list">
      <li class="takeaway-item">Circle-line relationship depends on comparing perpendicular distance d from center to line with radius r</li>
      <li class="takeaway-item">d < r: Two intersection points (secant line creates chord)</li>
      <li class="takeaway-item">d = r: One intersection point (tangent line touches circle)</li>
      <li class="takeaway-item">d > r: No intersection (line completely outside circle)</li>
      <li class="takeaway-item">Distance formula: d = |ax₀ + by₀ + c| / √(a² + b²) where (x₀,y₀) is center</li>
      <li class="takeaway-item">Tangent lines are perpendicular to radius at point of tangency</li>
      <li class="takeaway-item">When d = 0, line passes through center, always intersects at two points (diameter)</li>
      <li class="takeaway-item">Essential for geometric constructions, collision detection, and analytic geometry</li>
     </ul>
    </div>
   </div>
  </div>

  <script>
   function calculateRelationship() {
    try {
     const h = parseFloat(document.getElementById('centerX').value);
     const k = parseFloat(document.getElementById('centerY').value);
     const r = parseFloat(document.getElementById('radius').value);
     const a = parseFloat(document.getElementById('lineA').value);
     const b = parseFloat(document.getElementById('lineB').value);
     const c = parseFloat(document.getElementById('lineC').value);

     if (isNaN(h) || isNaN(k) || isNaN(r) || isNaN(a) || isNaN(b) || isNaN(c)) {
      throw new Error('All values must be valid numbers');
     }

     if (r <= 0) {
      throw new Error('Radius must be positive');
     }

     if (a === 0 && b === 0) {
      throw new Error('Line coefficients a and b cannot both be zero');
     }

     // Calculate distance
     const numerator = Math.abs(a * h + b * k + c);
     const denominator = Math.sqrt(a * a + b * b);
     const d = numerator / denominator;

     // Determine relationship
     let relationship = '';
     if (Math.abs(d - r) < 0.001) {
      relationship = 'd = r (Tangent - one intersection point)';
     } else if (d < r) {
      relationship = 'd < r (Two intersection points)';
     } else {
      relationship = 'd > r (No intersection)';
     }

     // Update display
     document.getElementById('circleDisplay').innerHTML = `<strong>Circle:</strong> (x - ${h})² + (y - ${k})² = ${r}²`;

     let lineStr = '';
     if (b === 0) {
      lineStr = `${a}x ${c >= 0 ? '+ ' + c : '- ' + Math.abs(c)} = 0`;
     } else if (a === 0) {
      lineStr = `${b}y ${c >= 0 ? '+ ' + c : '- ' + Math.abs(c)} = 0`;
     } else {
      lineStr = `${a}x ${b >= 0 ? '+ ' + b : '' + b}y ${c >= 0 ? '+ ' + c : '- ' + Math.abs(c)} = 0`;
     }
     document.getElementById('lineDisplay').innerHTML = `<strong>Line:</strong> ${lineStr}`;

     document.getElementById('distanceDisplay').innerHTML = `<strong>Distance d:</strong> ${d.toFixed(3)}`;
     document.getElementById('relationshipDisplay').innerHTML = `<strong>Relationship:</strong> ${relationship}`;

     document.getElementById('errorMessage').style.display = 'none';
    } catch (error) {
     document.getElementById('errorMessage').textContent = error.message;
     document.getElementById('errorMessage').style.display = 'block';
    }
   }

   function resetDemo() {
    document.getElementById('centerX').value = '0';
    document.getElementById('centerY').value = '0';
    document.getElementById('radius').value = '3';
    document.getElementById('lineA').value = '1';
    document.getElementById('lineB').value = '0';
    document.getElementById('lineC').value = '-2';
    calculateRelationship();
    document.getElementById('errorMessage').style.display = 'none';
   }

   function showExample(exampleNumber) {
    const detail = document.getElementById('exampleDetail');
    let content = '';

    switch(exampleNumber) {
     case 1:
      content = `
       <h4>Detailed Example 1 - Two Intersection Points</h4>
       <div class="calculation-steps">
        <div class="calculation-step">Circle: (x-1)² + (y-2)² = 9, center (1,2), r = 3</div>
        <div class="calculation-step">Line: x + y - 1 = 0 ⇒ 1x + 1y - 1 = 0</div>
        <div class="calculation-step">Distance: d = |1(1) + 1(2) - 1| / √(1² + 1²) = |1 + 2 - 1| / √2 = 2/√2 = √2 ≈ 1.41</div>
        <div class="calculation-step">Since d ≈ 1.41 < r = 3, the line intersects the circle at two points</div>
        <div class="calculation-step">Substitute line into circle: (x-1)² + ((1-x)-2)² = 9</div>
        <div class="calculation-step">Solve: (x-1)² + (x-3)² = 9 ⇒ 2(x-2)² = 9 ⇒ x-2 = ±√(9/2) = ±(3/√2)</div>
        <div class="calculation-step">x = 2 ± 3/√2, then y = 1 - x</div>
       </div>
      `;
      break;
     case 2:
      content = `
       <h4>Detailed Example 2 - Tangent Case</h4>
       <div class="calculation-steps">
        <div class="calculation-step">Circle: x² + y² = 25, center (0,0), r = 5</div>
        <div class="calculation-step">Line: 3x + 4y - 25 = 0</div>
        <div class="calculation-step">Distance: d = |3(0) + 4(0) - 25| / √(3² + 4²) = 25 / 5 = 5</div>
        <div class="calculation-step">Since d = 5 = r = 5, the line is tangent to the circle</div>
        <div class="calculation-step">Point of tangency: Solve system of circle and line equations</div>
        <div class="calculation-step">From line: 4y = 25 - 3x ⇒ y = (25-3x)/4</div>
        <div class="calculation-step">Substitute: x² + [(25-3x)/4]² = 25</div>
        <div class="calculation-step">Multiply by 16: 16x² + (25-3x)² = 400</div>
        <div class="calculation-step">625 - 150x + 9x² + 16x² = 400 ⇒ 25x² - 150x + 225 = 0</div>
        <div class="calculation-step">(5x - 15)² = 0 ⇒ x = 3, y = (25-9)/4 = 4</div>
        <div class="calculation-step">Tangent point: (3,4)</div>
       </div>
      `;
      break;
     case 3:
      content = `
       <h4>Detailed Example 3 - No Intersection</h4>
       <div class="calculation-steps">
        <div class="calculation-step">Circle: (x+2)² + (y-1)² = 4, center (-2,1), r = 2</div>
        <div class="calculation-step">Line: y = 5 ⇒ 0x + 1y - 5 = 0</div>
        <div class="calculation-step">Distance: d = |0(-2) + 1(1) - 5| / √(0² + 1²) = |-4| / 1 = 4</div>
        <div class="calculation-step">Since d = 4 > r = 2, the line does not intersect the circle</div>
        <div class="calculation-step">Minimum distance between line and circle: d - r = 4 - 2 = 2</div>
        <div class="calculation-step">The line y = 5 is 2 units above the highest point of the circle</div>
       </div>
      `;
      break;
    }

    detail.innerHTML = content;
    detail.style.display = 'block';
    MathJax.typesetPromise();
   }

   function toggleSolution(problemNumber) {
    const solution = document.getElementById('solution' + problemNumber);
    if (solution.style.display === 'none' || solution.style.display === '') {
     solution.style.display = 'block';
    } else {
     solution.style.display = 'none';
    }
   }

   // Initialize canvas visualizations
   window.addEventListener('load', function() {
    // Two Intersection Points
    const canvas1 = document.getElementById('twoPointsCanvas');
    const ctx1 = canvas1.getContext('2d');
    const w1 = canvas1.width;
    const h1 = canvas1.height;

    const x0_1 = 60, y0_1 = h1 - 60;
    const scale1 = 35;

    // Grid
    ctx1.strokeStyle = '#e8e8e8';
    ctx1.lineWidth = 0.8;
    for (let i = -1; i <= 11; i++) {
     ctx1.beginPath();
     ctx1.moveTo(x0_1 + i * scale1, 20);
     ctx1.lineTo(x0_1 + i * scale1, h1 - 20);
     ctx1.stroke();

     ctx1.beginPath();
     ctx1.moveTo(30, y0_1 - i * scale1);
     ctx1.lineTo(w1 - 20, y0_1 - i * scale1);
     ctx1.stroke();
    }

    // Axes
    ctx1.strokeStyle = '#000';
    ctx1.lineWidth = 2;
    ctx1.beginPath();
    ctx1.moveTo(x0_1, 20);
    ctx1.lineTo(x0_1, h1 - 20);
    ctx1.stroke();

    ctx1.beginPath();
    ctx1.moveTo(30, y0_1);
    ctx1.lineTo(w1 - 20, y0_1);
    ctx1.stroke();

    // Arrow tips
    ctx1.fillStyle = '#000';
    ctx1.beginPath();
    ctx1.moveTo(w1 - 20, y0_1);
    ctx1.lineTo(w1 - 27, y0_1 - 4);
    ctx1.lineTo(w1 - 27, y0_1 + 4);
    ctx1.fill();

    ctx1.beginPath();
    ctx1.moveTo(x0_1, 20);
    ctx1.lineTo(x0_1 - 4, 27);
    ctx1.lineTo(x0_1 + 4, 27);
    ctx1.fill();

    // Axis labels
    ctx1.font = '14px Arial';
    ctx1.fillStyle = '#000';
    ctx1.textAlign = 'center';
    ctx1.fillText('x', w1 - 10, y0_1 + 20);
    ctx1.fillText('y', x0_1 - 20, 15);
    ctx1.fillText('O', x0_1 - 15, y0_1 + 15);

    // Circle with center (5, 5) and radius 3
    const c1x = 5, c1y = 5, r1 = 3;

    ctx1.strokeStyle = '#3498db';
    ctx1.lineWidth = 2.5;
    ctx1.beginPath();
    ctx1.arc(x0_1 + c1x * scale1, y0_1 - c1y * scale1, r1 * scale1, 0, 2*Math.PI);
    ctx1.stroke();

    // Center point
    ctx1.fillStyle = '#e74c3c';
    ctx1.beginPath();
    ctx1.arc(x0_1 + c1x * scale1, y0_1 - c1y * scale1, 5, 0, 2*Math.PI);
    ctx1.fill();

    // Line: y = 3.5 (horizontal, d = 1.5 < r = 3)
    const lineY1 = 3.5;
    const d1 = Math.abs(c1y - lineY1);

    ctx1.strokeStyle = '#27ae60';
    ctx1.lineWidth = 2.5;
    ctx1.beginPath();
    ctx1.moveTo(x0_1 + 1 * scale1, y0_1 - lineY1 * scale1);
    ctx1.lineTo(x0_1 + 9 * scale1, y0_1 - lineY1 * scale1);
    ctx1.stroke();

    // Distance line (perpendicular from center to line)
    ctx1.strokeStyle = '#9b59b6';
    ctx1.lineWidth = 2;
    ctx1.setLineDash([5, 5]);
    ctx1.beginPath();
    ctx1.moveTo(x0_1 + c1x * scale1, y0_1 - c1y * scale1);
    ctx1.lineTo(x0_1 + c1x * scale1, y0_1 - lineY1 * scale1);
    ctx1.stroke();
    ctx1.setLineDash([]);

    // Foot of perpendicular
    ctx1.fillStyle = '#9b59b6';
    ctx1.beginPath();
    ctx1.arc(x0_1 + c1x * scale1, y0_1 - lineY1 * scale1, 4, 0, 2*Math.PI);
    ctx1.fill();

    // Right angle marker
    const cornerSize1 = 10;
    ctx1.strokeStyle = '#9b59b6';
    ctx1.lineWidth = 1.5;
    ctx1.beginPath();
    ctx1.moveTo(x0_1 + c1x * scale1 - cornerSize1, y0_1 - lineY1 * scale1);
    ctx1.lineTo(x0_1 + c1x * scale1 - cornerSize1, y0_1 - lineY1 * scale1 - cornerSize1);
    ctx1.lineTo(x0_1 + c1x * scale1, y0_1 - lineY1 * scale1 - cornerSize1);
    ctx1.stroke();

    // Radius line
    ctx1.strokeStyle = '#e74c3c';
    ctx1.lineWidth = 1.5;
    ctx1.setLineDash([5, 5]);
    ctx1.beginPath();
    ctx1.moveTo(x0_1 + c1x * scale1, y0_1 - c1y * scale1);
    ctx1.lineTo(x0_1 + c1x * scale1, y0_1 - (c1y - r1) * scale1);
    ctx1.stroke();
    ctx1.setLineDash([]);

    // Labels
    ctx1.font = 'italic 16px Georgia';
    ctx1.fillStyle = '#e74c3c';
    ctx1.textAlign = 'left';
    ctx1.fillText('C', x0_1 + c1x * scale1 + 10, y0_1 - c1y * scale1 - 5);

    ctx1.fillStyle = '#27ae60';
    ctx1.fillText('ℓ', x0_1 + 8.5 * scale1, y0_1 - lineY1 * scale1 - 10);

    ctx1.font = '14px Arial';
    ctx1.fillStyle = '#9b59b6';
    ctx1.textAlign = 'left';
    ctx1.fillText('d', x0_1 + c1x * scale1 + 10, y0_1 - (c1y + lineY1)/2 * scale1);

    ctx1.fillStyle = '#e74c3c';
    ctx1.fillText('r', x0_1 + c1x * scale1 + 10, y0_1 - (c1y - r1/2) * scale1);

    ctx1.fillStyle = '#000';
    ctx1.fillText('d < r', x0_1 + 7.5 * scale1, y0_1 - 7.5 * scale1);

    // Tangent Case
    const canvas2 = document.getElementById('tangentCanvas');
    const ctx2 = canvas2.getContext('2d');
    const w2 = canvas2.width;
    const h2 = canvas2.height;

    const x0_2 = 60, y0_2 = h2 - 60;
    const scale2 = 35;

    // Grid
    ctx2.strokeStyle = '#e8e8e8';
    ctx2.lineWidth = 0.8;
    for (let i = -1; i <= 11; i++) {
     ctx2.beginPath();
     ctx2.moveTo(x0_2 + i * scale2, 20);
     ctx2.lineTo(x0_2 + i * scale2, h2 - 20);
     ctx2.stroke();

     ctx2.beginPath();
     ctx2.moveTo(30, y0_2 - i * scale2);
     ctx2.lineTo(w2 - 20, y0_2 - i * scale2);
     ctx2.stroke();
    }

    // Axes
    ctx2.strokeStyle = '#000';
    ctx2.lineWidth = 2;
    ctx2.beginPath();
    ctx2.moveTo(x0_2, 20);
    ctx2.lineTo(x0_2, h2 - 20);
    ctx2.stroke();

    ctx2.beginPath();
    ctx2.moveTo(30, y0_2);
    ctx2.lineTo(w2 - 20, y0_2);
    ctx2.stroke();

    // Arrow tips
    ctx2.fillStyle = '#000';
    ctx2.beginPath();
    ctx2.moveTo(w2 - 20, y0_2);
    ctx2.lineTo(w2 - 27, y0_2 - 4);
    ctx2.lineTo(w2 - 27, y0_2 + 4);
    ctx2.fill();

    ctx2.beginPath();
    ctx2.moveTo(x0_2, 20);
    ctx2.lineTo(x0_2 - 4, 27);
    ctx2.lineTo(x0_2 + 4, 27);
    ctx2.fill();

    // Axis labels
    ctx2.font = '14px Arial';
    ctx2.fillStyle = '#000';
    ctx2.textAlign = 'center';
    ctx2.fillText('x', w2 - 10, y0_2 + 20);
    ctx2.fillText('y', x0_2 - 20, 15);
    ctx2.fillText('O', x0_2 - 15, y0_2 + 15);

    // Circle with center (5, 5) and radius 3
    const c2x = 5, c2y = 5, r2 = 3;

    ctx2.strokeStyle = '#3498db';
    ctx2.lineWidth = 2.5;
    ctx2.beginPath();
    ctx2.arc(x0_2 + c2x * scale2, y0_2 - c2y * scale2, r2 * scale2, 0, 2*Math.PI);
    ctx2.stroke();

    // Center point
    ctx2.fillStyle = '#e74c3c';
    ctx2.beginPath();
    ctx2.arc(x0_2 + c2x * scale2, y0_2 - c2y * scale2, 5, 0, 2*Math.PI);
    ctx2.fill();

    // Line: y = 2 (horizontal, d = 3 = r)
    const lineY2 = 2;

    ctx2.strokeStyle = '#27ae60';
    ctx2.lineWidth = 2.5;
    ctx2.beginPath();
    ctx2.moveTo(x0_2 + 1 * scale2, y0_2 - lineY2 * scale2);
    ctx2.lineTo(x0_2 + 9 * scale2, y0_2 - lineY2 * scale2);
    ctx2.stroke();

    // Distance line (equals radius)
    ctx2.strokeStyle = '#9b59b6';
    ctx2.lineWidth = 2;
    ctx2.setLineDash([5, 5]);
    ctx2.beginPath();
    ctx2.moveTo(x0_2 + c2x * scale2, y0_2 - c2y * scale2);
    ctx2.lineTo(x0_2 + c2x * scale2, y0_2 - lineY2 * scale2);
    ctx2.stroke();
    ctx2.setLineDash([]);

    // Tangent point
    ctx2.fillStyle = '#9b59b6';
    ctx2.beginPath();
    ctx2.arc(x0_2 + c2x * scale2, y0_2 - lineY2 * scale2, 5, 0, 2*Math.PI);
    ctx2.fill();

    // Right angle marker
    const cornerSize2 = 10;
    ctx2.strokeStyle = '#9b59b6';
    ctx2.lineWidth = 1.5;
    ctx2.beginPath();
    ctx2.moveTo(x0_2 + c2x * scale2 - cornerSize2, y0_2 - lineY2 * scale2);
    ctx2.lineTo(x0_2 + c2x * scale2 - cornerSize2, y0_2 - lineY2 * scale2 - cornerSize2);
    ctx2.lineTo(x0_2 + c2x * scale2, y0_2 - lineY2 * scale2 - cornerSize2);
    ctx2.stroke();

    // Labels
    ctx2.font = 'italic 16px Georgia';
    ctx2.fillStyle = '#e74c3c';
    ctx2.textAlign = 'left';
    ctx2.fillText('C', x0_2 + c2x * scale2 + 10, y0_2 - c2y * scale2 - 5);

    ctx2.fillStyle = '#27ae60';
    ctx2.fillText('ℓ', x0_2 + 8.5 * scale2, y0_2 - lineY2 * scale2 - 10);

    ctx2.font = '14px Arial';
    ctx2.fillStyle = '#9b59b6';
    ctx2.textAlign = 'left';
    ctx2.fillText('d = r', x0_2 + c2x * scale2 + 10, y0_2 - (c2y + lineY2)/2 * scale2);

    ctx2.fillStyle = '#000';
    ctx2.fillText('d = r', x0_2 + 7.5 * scale2, y0_2 - 7.5 * scale2);

    // No Intersection
    const canvas3 = document.getElementById('noPointsCanvas');
    const ctx3 = canvas3.getContext('2d');
    const w3 = canvas3.width;
    const h3 = canvas3.height;

    const x0_3 = 60, y0_3 = h3 - 60;
    const scale3 = 35;

    // Grid
    ctx3.strokeStyle = '#e8e8e8';
    ctx3.lineWidth = 0.8;
    for (let i = -1; i <= 11; i++) {
     ctx3.beginPath();
     ctx3.moveTo(x0_3 + i * scale3, 20);
     ctx3.lineTo(x0_3 + i * scale3, h3 - 20);
     ctx3.stroke();

     ctx3.beginPath();
     ctx3.moveTo(30, y0_3 - i * scale3);
     ctx3.lineTo(w3 - 20, y0_3 - i * scale3);
     ctx3.stroke();
    }

    // Axes
    ctx3.strokeStyle = '#000';
    ctx3.lineWidth = 2;
    ctx3.beginPath();
    ctx3.moveTo(x0_3, 20);
    ctx3.lineTo(x0_3, h3 - 20);
    ctx3.stroke();

    ctx3.beginPath();
    ctx3.moveTo(30, y0_3);
    ctx3.lineTo(w3 - 20, y0_3);
    ctx3.stroke();

    // Arrow tips
    ctx3.fillStyle = '#000';
    ctx3.beginPath();
    ctx3.moveTo(w3 - 20, y0_3);
    ctx3.lineTo(w3 - 27, y0_3 - 4);
    ctx3.lineTo(w3 - 27, y0_3 + 4);
    ctx3.fill();

    ctx3.beginPath();
    ctx3.moveTo(x0_3, 20);
    ctx3.lineTo(x0_3 - 4, 27);
    ctx3.lineTo(x0_3 + 4, 27);
    ctx3.fill();

    // Axis labels
    ctx3.font = '14px Arial';
    ctx3.fillStyle = '#000';
    ctx3.textAlign = 'center';
    ctx3.fillText('x', w3 - 10, y0_3 + 20);
    ctx3.fillText('y', x0_3 - 20, 15);
    ctx3.fillText('O', x0_3 - 15, y0_3 + 15);

    // Circle with center (5, 5) and radius 3
    const c3x = 5, c3y = 5, r3 = 3;

    ctx3.strokeStyle = '#3498db';
    ctx3.lineWidth = 2.5;
    ctx3.beginPath();
    ctx3.arc(x0_3 + c3x * scale3, y0_3 - c3y * scale3, r3 * scale3, 0, 2*Math.PI);
    ctx3.stroke();

    // Center point
    ctx3.fillStyle = '#e74c3c';
    ctx3.beginPath();
    ctx3.arc(x0_3 + c3x * scale3, y0_3 - c3y * scale3, 5, 0, 2*Math.PI);
    ctx3.fill();

    // Line: y = 0.5 (horizontal, d = 4.5 > r = 3)
    const lineY3 = 0.5;

    ctx3.strokeStyle = '#27ae60';
    ctx3.lineWidth = 2.5;
    ctx3.beginPath();
    ctx3.moveTo(x0_3 + 1 * scale3, y0_3 - lineY3 * scale3);
    ctx3.lineTo(x0_3 + 9 * scale3, y0_3 - lineY3 * scale3);
    ctx3.stroke();

    // Distance line
    ctx3.strokeStyle = '#9b59b6';
    ctx3.lineWidth = 2;
    ctx3.setLineDash([5, 5]);
    ctx3.beginPath();
    ctx3.moveTo(x0_3 + c3x * scale3, y0_3 - c3y * scale3);
    ctx3.lineTo(x0_3 + c3x * scale3, y0_3 - lineY3 * scale3);
    ctx3.stroke();
    ctx3.setLineDash([]);

    // Foot of perpendicular
    ctx3.fillStyle = '#9b59b6';
    ctx3.beginPath();
    ctx3.arc(x0_3 + c3x * scale3, y0_3 - lineY3 * scale3, 4, 0, 2*Math.PI);
    ctx3.fill();

    // Right angle marker
    const cornerSize3 = 10;
    ctx3.strokeStyle = '#9b59b6';
    ctx3.lineWidth = 1.5;
    ctx3.beginPath();
    ctx3.moveTo(x0_3 + c3x * scale3 - cornerSize3, y0_3 - lineY3 * scale3);
    ctx3.lineTo(x0_3 + c3x * scale3 - cornerSize3, y0_3 - lineY3 * scale3 - cornerSize3);
    ctx3.lineTo(x0_3 + c3x * scale3, y0_3 - lineY3 * scale3 - cornerSize3);
    ctx3.stroke();

    // Radius line
    ctx3.strokeStyle = '#e74c3c';
    ctx3.lineWidth = 1.5;
    ctx3.setLineDash([5, 5]);
    ctx3.beginPath();
    ctx3.moveTo(x0_3 + c3x * scale3, y0_3 - c3y * scale3);
    ctx3.lineTo(x0_3 + c3x * scale3, y0_3 - (c3y - r3) * scale3);
    ctx3.stroke();
    ctx3.setLineDash([]);

    // Labels
    ctx3.font = 'italic 16px Georgia';
    ctx3.fillStyle = '#e74c3c';
    ctx3.textAlign = 'left';
    ctx3.fillText('C', x0_3 + c3x * scale3 + 10, y0_3 - c3y * scale3 - 5);

    ctx3.fillStyle = '#27ae60';
    ctx3.fillText('ℓ', x0_3 + 8.5 * scale3, y0_3 - lineY3 * scale3 - 10);

    ctx3.font = '14px Arial';
    ctx3.fillStyle = '#9b59b6';
    ctx3.textAlign = 'left';
    ctx3.fillText('d', x0_3 + c3x * scale3 + 10, y0_3 - (c3y + lineY3)/2 * scale3);

    ctx3.fillStyle = '#e74c3c';
    ctx3.fillText('r', x0_3 + c3x * scale3 + 10, y0_3 - (c3y - r3/2) * scale3);

    ctx3.fillStyle = '#000';
    ctx3.fillText('d > r', x0_3 + 7.5 * scale3, y0_3 - 7.5 * scale3);
    // Initialize calculator
    calculateRelationship();
   });
  </script>
 </body>
</html>